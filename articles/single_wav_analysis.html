<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Single WAV File Analysis with ASAP • ASAP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Single WAV File Analysis with ASAP">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASAP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_wav_analysis.html">Single WAV File Analysis with ASAP</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single WAV File Analysis with ASAP</h1>
            
      

      <div class="d-none name"><code>single_wav_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use ASAP functions for analyzing
single WAV files of zebra finch vocalizations. While ASAP is designed
for large-scale longitudinal studies, all core analysis functions work
directly with individual audio files, making it easy to explore and
understand your data.</p>
<p>We’ll cover:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Audio Visualization</strong> - View spectrograms</li>
<li>
<strong>Bout Detection</strong> - Find singing periods</li>
<li>
<strong>Syllable Segmentation</strong> - Detect individual
syllables</li>
<li>
<strong>Spectral Entropy</strong> - Measure spectral structure</li>
<li>
<strong>Fundamental Frequency</strong> - Extract pitch contours</li>
<li>
<strong>Amplitude Envelope</strong> - Analyze temporal dynamics</li>
</ol>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lxiao06.github.io/ASAP/">ASAP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get path to example WAV file included with the package</span></span>
<span><span class="va">wav_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"zf_example.wav"</span>, package <span class="op">=</span> <span class="st">"ASAP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="audio-visualization">1. Audio Visualization<a class="anchor" aria-label="anchor" href="#audio-visualization"></a>
</h2>
<p>The <code><a href="../reference/visualize_song.html">visualize_song()</a></code> function creates spectrogram
visualizations of audio recordings. This is typically the first step in
exploring your data.</p>
<div class="section level3">
<h3 id="full-recording">Full recording<a class="anchor" aria-label="anchor" href="#full-recording"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize the entire recording</span></span>
<span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/visualize-full-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="specific-time-window">Specific time window<a class="anchor" aria-label="anchor" href="#specific-time-window"></a>
</h3>
<p>You can focus on a specific time range using
<code>start_time_in_second</code> and
<code>end_time_in_second</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize a 3-second segment</span></span>
<span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span>, </span>
<span>               start_time_in_second <span class="op">=</span> <span class="fl">1</span>, </span>
<span>               end_time_in_second <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/visualize-segment-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="bout-detection">2. Bout Detection<a class="anchor" aria-label="anchor" href="#bout-detection"></a>
</h2>
<p>A “bout” is a continuous period of singing. The
<code><a href="../reference/find_bout.html">find_bout()</a></code> function automatically detects bout boundaries
using RMS (root mean square) amplitude thresholding with bandpass
filtering.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Detect bouts in the recording</span></span>
<span><span class="va">bouts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_bout.html">find_bout</a></span><span class="op">(</span><span class="va">wav_file</span>, </span>
<span>                   rms_threshold <span class="op">=</span> <span class="fl">0.1</span>,    <span class="co"># Amplitude threshold (0-1)</span></span>
<span>                   min_duration <span class="op">=</span> <span class="fl">0.7</span>,      <span class="co"># Minimum bout length in seconds</span></span>
<span>                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>             <span class="co"># Show detection plot</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/find-bout-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># View detected bouts as a table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">bouts</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">filename</th>
<th align="right">selec</th>
<th align="right">start_time</th>
<th align="right">end_time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">1</td>
<td align="right">1.057</td>
<td align="right">3.553</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">2</td>
<td align="right">4.156</td>
<td align="right">4.946</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="key-parameters">Key parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h3>
<ul>
<li>
<code>rms_threshold</code>: Higher values require louder sounds;
lower values detect quieter vocalizations</li>
<li>
<code>min_duration</code>: Minimum bout length (filters out short
sounds/noise)</li>
<li>
<code>freq_range</code>: Bandpass filter range (default: 1-8 kHz for
zebra finch)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="syllable-segmentation">3. Syllable Segmentation<a class="anchor" aria-label="anchor" href="#syllable-segmentation"></a>
</h2>
<p>The <code><a href="../reference/segment.html">segment()</a></code> function detects individual syllables
within a specified time window using dynamic spectral thresholding.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Segment syllables in a time window</span></span>
<span><span class="va">syllables</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.html">segment</a></span><span class="op">(</span><span class="va">wav_file</span>, </span>
<span>                     start_time <span class="op">=</span> <span class="fl">1</span>,          <span class="co"># Start time (seconds)</span></span>
<span>                     end_time <span class="op">=</span> <span class="fl">5</span>,            <span class="co"># End time (seconds)</span></span>
<span>                     flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>,          <span class="co"># Frequency limits (kHz)</span></span>
<span>                     silence_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                     min_syllable_ms <span class="op">=</span> <span class="fl">20</span>,    <span class="co"># Minimum syllable duration</span></span>
<span>                     max_syllable_ms <span class="op">=</span> <span class="fl">240</span>,   <span class="co"># Maximum syllable duration</span></span>
<span>                     min_level_db <span class="op">=</span> <span class="fl">10</span>,       <span class="co"># Starting threshold (dB)</span></span>
<span>                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/segment-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># View detected syllables as a table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">syllables</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="17%">
<col width="7%">
<col width="11%">
<col width="8%">
<col width="7%">
<col width="12%">
<col width="10%">
<col width="10%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">filename</th>
<th align="right">selec</th>
<th align="right">threshold</th>
<th align="right">.start</th>
<th align="right">.end</th>
<th align="right">start_time</th>
<th align="right">end_time</th>
<th align="right">duration</th>
<th align="right">silence_gap</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0.061</td>
<td align="right">0.123</td>
<td align="right">1.061</td>
<td align="right">1.123</td>
<td align="right">0.061</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">2</td>
<td align="right">10</td>
<td align="right">0.151</td>
<td align="right">0.199</td>
<td align="right">1.151</td>
<td align="right">1.199</td>
<td align="right">0.047</td>
<td align="right">0.028</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">3</td>
<td align="right">10</td>
<td align="right">0.260</td>
<td align="right">0.312</td>
<td align="right">1.260</td>
<td align="right">1.312</td>
<td align="right">0.052</td>
<td align="right">0.061</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">4</td>
<td align="right">10</td>
<td align="right">0.359</td>
<td align="right">0.411</td>
<td align="right">1.359</td>
<td align="right">1.411</td>
<td align="right">0.052</td>
<td align="right">0.047</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">0.444</td>
<td align="right">0.520</td>
<td align="right">1.444</td>
<td align="right">1.520</td>
<td align="right">0.076</td>
<td align="right">0.033</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">6</td>
<td align="right">10</td>
<td align="right">0.548</td>
<td align="right">0.610</td>
<td align="right">1.548</td>
<td align="right">1.610</td>
<td align="right">0.061</td>
<td align="right">0.028</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">0.624</td>
<td align="right">0.837</td>
<td align="right">1.624</td>
<td align="right">1.837</td>
<td align="right">0.213</td>
<td align="right">0.014</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">0.875</td>
<td align="right">0.983</td>
<td align="right">1.875</td>
<td align="right">1.983</td>
<td align="right">0.109</td>
<td align="right">0.038</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">0.993</td>
<td align="right">1.050</td>
<td align="right">1.993</td>
<td align="right">2.050</td>
<td align="right">0.057</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">1.092</td>
<td align="right">1.215</td>
<td align="right">2.092</td>
<td align="right">2.215</td>
<td align="right">0.123</td>
<td align="right">0.043</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">11</td>
<td align="right">10</td>
<td align="right">1.333</td>
<td align="right">1.537</td>
<td align="right">2.333</td>
<td align="right">2.537</td>
<td align="right">0.203</td>
<td align="right">0.118</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">1.669</td>
<td align="right">1.735</td>
<td align="right">2.669</td>
<td align="right">2.735</td>
<td align="right">0.066</td>
<td align="right">0.132</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">13</td>
<td align="right">10</td>
<td align="right">1.754</td>
<td align="right">1.839</td>
<td align="right">2.754</td>
<td align="right">2.839</td>
<td align="right">0.085</td>
<td align="right">0.019</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">14</td>
<td align="right">10</td>
<td align="right">1.858</td>
<td align="right">1.920</td>
<td align="right">2.858</td>
<td align="right">2.920</td>
<td align="right">0.061</td>
<td align="right">0.019</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">15</td>
<td align="right">10</td>
<td align="right">1.934</td>
<td align="right">2.156</td>
<td align="right">2.934</td>
<td align="right">3.156</td>
<td align="right">0.222</td>
<td align="right">0.014</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">16</td>
<td align="right">10</td>
<td align="right">2.184</td>
<td align="right">2.293</td>
<td align="right">3.184</td>
<td align="right">3.293</td>
<td align="right">0.109</td>
<td align="right">0.028</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">17</td>
<td align="right">10</td>
<td align="right">2.307</td>
<td align="right">2.359</td>
<td align="right">3.307</td>
<td align="right">3.359</td>
<td align="right">0.052</td>
<td align="right">0.014</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">18</td>
<td align="right">10</td>
<td align="right">2.402</td>
<td align="right">2.544</td>
<td align="right">3.402</td>
<td align="right">3.544</td>
<td align="right">0.142</td>
<td align="right">0.043</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">19</td>
<td align="right">10</td>
<td align="right">3.177</td>
<td align="right">3.239</td>
<td align="right">4.177</td>
<td align="right">4.239</td>
<td align="right">0.061</td>
<td align="right">0.634</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">20</td>
<td align="right">10</td>
<td align="right">3.272</td>
<td align="right">3.343</td>
<td align="right">4.272</td>
<td align="right">4.343</td>
<td align="right">0.071</td>
<td align="right">0.033</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">21</td>
<td align="right">10</td>
<td align="right">3.352</td>
<td align="right">3.437</td>
<td align="right">4.352</td>
<td align="right">4.437</td>
<td align="right">0.085</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">22</td>
<td align="right">10</td>
<td align="right">3.456</td>
<td align="right">3.513</td>
<td align="right">4.456</td>
<td align="right">4.513</td>
<td align="right">0.057</td>
<td align="right">0.019</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">23</td>
<td align="right">10</td>
<td align="right">3.527</td>
<td align="right">3.754</td>
<td align="right">4.527</td>
<td align="right">4.754</td>
<td align="right">0.227</td>
<td align="right">0.014</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">24</td>
<td align="right">10</td>
<td align="right">3.778</td>
<td align="right">3.882</td>
<td align="right">4.778</td>
<td align="right">4.882</td>
<td align="right">0.104</td>
<td align="right">0.024</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">25</td>
<td align="right">10</td>
<td align="right">3.901</td>
<td align="right">3.948</td>
<td align="right">4.901</td>
<td align="right">4.948</td>
<td align="right">0.047</td>
<td align="right">0.019</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="understanding-the-output">Understanding the output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h3>
<p>The returned data frame contains:</p>
<ul>
<li>
<code>start_time</code>/<code>end_time</code>: Syllable boundaries
(seconds)</li>
<li>
<code>duration</code>: Syllable length</li>
<li>
<code>silence_gap</code>: Gap before the next syllable (useful for
syntax analysis)</li>
<li>
<code>selec</code>: Selection number for tracking</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="spectral-entropy-analysis">4. Spectral Entropy Analysis<a class="anchor" aria-label="anchor" href="#spectral-entropy-analysis"></a>
</h2>
<p>Spectral entropy measures the “randomness” or structure in the
frequency distribution. Harmonic sounds (like syllables) have low
entropy, while noisy sounds have high entropy.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate spectral entropy for a segment</span></span>
<span><span class="va">entropy_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spectral_entropy.html">spectral_entropy</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>                                   start_time <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                                   end_time <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"wiener"</span>,  <span class="co"># or "shannon"</span></span>
<span>                                   normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/spectral-entropy-1.png" class="r-plt" alt="" width="100%"></p>
<div class="section level3">
<h3 id="interpreting-entropy-values">Interpreting entropy values<a class="anchor" aria-label="anchor" href="#interpreting-entropy-values"></a>
</h3>
<ul>
<li>
<strong>Low entropy (near 0)</strong>: Structured, harmonic sounds
(e.g., tonal syllables)</li>
<li>
<strong>High entropy (near 1)</strong>: Noisy, unstructured sounds
(e.g., calls, noise)</li>
</ul>
</div>
<div class="section level3">
<h3 id="available-methods">Available methods<a class="anchor" aria-label="anchor" href="#available-methods"></a>
</h3>
<ul>
<li>
<code>"wiener"</code>: Wiener entropy (ratio of geometric to
arithmetic mean)</li>
<li>
<code>"shannon"</code>: Shannon entropy (information-theoretic
measure)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="fundamental-frequency-pitch-analysis">5. Fundamental Frequency (Pitch) Analysis<a class="anchor" aria-label="anchor" href="#fundamental-frequency-pitch-analysis"></a>
</h2>
<p>The <code><a href="../reference/Fundamental_Frequency.html">FF()</a></code> function extracts the fundamental frequency
(F0) contour, which represents the perceived pitch of the vocalization
over time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract fundamental frequency</span></span>
<span><span class="va">pitch_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Fundamental_Frequency.html">FF</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>                   start_time <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                   end_time <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                   method <span class="op">=</span> <span class="st">"cepstrum"</span>,  <span class="co"># Cepstral analysis</span></span>
<span>                   fmax <span class="op">=</span> <span class="fl">1400</span>,          <span class="co"># Maximum F0 to detect (Hz)</span></span>
<span>                   threshold <span class="op">=</span> <span class="fl">10</span>,       <span class="co"># Confidence threshold</span></span>
<span>                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/fundamental-frequency-1.png" class="r-plt" alt="" width="100%"></p>
<div class="section level3">
<h3 id="key-parameters-1">Key parameters<a class="anchor" aria-label="anchor" href="#key-parameters-1"></a>
</h3>
<ul>
<li>
<code>fmax</code>: Maximum fundamental frequency to detect (1400 Hz
typical for zebra finch)</li>
<li>
<code>threshold</code>: Higher values filter out uncertain
estimates</li>
<li>
<code>method</code>: <code>"cepstrum"</code> (default) or
<code>"yin"</code> (requires Python librosa)</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-result-contains">The result contains:<a class="anchor" aria-label="anchor" href="#the-result-contains"></a>
</h3>
<ul>
<li>
<code>f0</code>: Fundamental frequency values over time</li>
<li>
<code>time</code>: Corresponding time stamps</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="amplitude-envelope">6. Amplitude Envelope<a class="anchor" aria-label="anchor" href="#amplitude-envelope"></a>
</h2>
<p>The amplitude envelope represents the temporal dynamics of sound
intensity. Use <code><a href="../reference/amp_env.html">amp_env()</a></code> on segmented data to extract
envelope profiles.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract amplitude envelope for the second bout</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">env_bout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amp_env.html">amp_env</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>, </span>
<span>                      wav_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span>,</span>
<span>                      msmooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">256</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                      norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/amplitude-envelope-bout-1.png" class="r-plt" alt="" width="100%"></p>
<p>We can also extract the envelope for individual syllables:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract amplitude envelope for the 7th syllable</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">syllables</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">syllables</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">env_syl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amp_env.html">amp_env</a></span><span class="op">(</span><span class="va">syllables</span><span class="op">[</span><span class="fl">7</span>, <span class="op">]</span>, </span>
<span>                     wav_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span>,</span>
<span>                     msmooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">256</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                     norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="single_wav_analysis_files/figure-html/amplitude-envelope-syllable-1.png" class="r-plt" alt="" width="100%"></p>
<div class="section level3">
<h3 id="smoothing-parameters">Smoothing parameters<a class="anchor" aria-label="anchor" href="#smoothing-parameters"></a>
</h3>
<p>The <code>msmooth</code> argument controls envelope smoothing:</p>
<ul>
<li>First value: Window length (samples)</li>
<li>Second value: Overlap percentage</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="putting-it-all-together">Putting It All Together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<p>Here’s a typical workflow for single-file analysis:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lxiao06.github.io/ASAP/">ASAP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Load and visualize</span></span>
<span><span class="va">wav_file</span> <span class="op">&lt;-</span> <span class="st">"path/to/your/recording.wav"</span></span>
<span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span>, start_time_in_second <span class="op">=</span> <span class="fl">0</span>, end_time_in_second <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Detect bouts</span></span>
<span><span class="va">bouts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_bout.html">find_bout</a></span><span class="op">(</span><span class="va">wav_file</span>, rms_threshold <span class="op">=</span> <span class="fl">0.1</span>, min_duration <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Segment syllables</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">syllables</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.html">segment</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>                       start_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">start_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                       end_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">end_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                       min_level_db <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># 4. Analyze acoustic features</span></span>
<span><span class="va">entropy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spectral_entropy.html">spectral_entropy</a></span><span class="op">(</span><span class="va">wav_file</span>, </span>
<span>                            start_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">start_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                            end_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">end_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pitch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Fundamental_Frequency.html">FF</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>            start_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">start_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            end_time <span class="op">=</span> <span class="va">bouts</span><span class="op">$</span><span class="va">end_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Extract amplitude envelope</span></span>
<span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amp_env.html">amp_env</a></span><span class="op">(</span><span class="va">bouts</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, </span>
<span>               wav_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span>,</span>
<span>               msmooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">256</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>               norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ASAP_0.3.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10        generics_0.1.4     tidyr_1.3.2        lattice_0.22-7    </span></span>
<span><span class="co">#&gt;  [5] digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5     grid_4.5.2        </span></span>
<span><span class="co">#&gt;  [9] RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_2.0.0     Matrix_1.7-4      </span></span>
<span><span class="co">#&gt; [13] tuneR_1.4.7        purrr_1.2.1        scales_1.4.0       pbapply_1.7-4     </span></span>
<span><span class="co">#&gt; [17] textshaping_1.0.4  jquerylib_0.1.4    cli_3.6.5          rlang_1.1.7       </span></span>
<span><span class="co">#&gt; [21] pbmcapply_1.5.1    fftw_1.0-9         seewave_2.2.4      cachem_1.1.0      </span></span>
<span><span class="co">#&gt; [25] yaml_2.3.12        av_0.9.6           tools_4.5.2        parallel_4.5.2    </span></span>
<span><span class="co">#&gt; [29] dplyr_1.1.4        ggplot2_4.0.1      reticulate_1.44.1  vctrs_0.7.0       </span></span>
<span><span class="co">#&gt; [33] R6_2.6.1           png_0.1-8          lifecycle_1.0.5    fs_1.6.6          </span></span>
<span><span class="co">#&gt; [37] MASS_7.3-65        ragg_1.5.0         pkgconfig_2.0.3    desc_1.4.3        </span></span>
<span><span class="co">#&gt; [41] pkgdown_2.2.0      pillar_1.11.1      bslib_0.9.0        gtable_0.3.6      </span></span>
<span><span class="co">#&gt; [45] glue_1.8.0         Rcpp_1.1.1         systemfonts_1.3.1  xfun_0.56         </span></span>
<span><span class="co">#&gt; [49] tibble_3.3.1       tidyselect_1.2.1   knitr_1.51         farver_2.1.2      </span></span>
<span><span class="co">#&gt; [53] htmltools_0.5.9    patchwork_1.3.2    rmarkdown_2.30     signal_1.8-1      </span></span>
<span><span class="co">#&gt; [57] compiler_4.5.2     S7_0.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lei Xiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
