<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Finding Motifs in Zebra Finch Song • ASAP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Finding Motifs in Zebra Finch Song">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASAP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_wav_analysis.html">Single WAV File Analysis with ASAP</a></li>
    <li><a class="dropdown-item" href="../articles/motif_detection.html">Finding Motifs in Zebra Finch Song</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Finding Motifs in Zebra Finch Song</h1>
            
      

      <div class="d-none name"><code>motif_detection.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to find and extract <strong>song
motifs</strong> from a single zebra finch WAV file using ASAP’s template
matching workflow. A motif is the stereotyped sequence of syllables that
adult male zebra finches repeat during singing.</p>
<p>The workflow involves:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Visualizing the song</strong> - Identify a clear motif
rendition</li>
<li>
<strong>Creating an audio clip</strong> - Extract a segment
containing the motif</li>
<li>
<strong>Creating a template</strong> - Select a distinctive syllable
as a template</li>
<li>
<strong>Detecting the template</strong> - Find all occurrences of
the template</li>
<li>
<strong>Extracting motifs</strong> - Define motif boundaries around
template detections</li>
<li>
<strong>Visualizing results</strong> - View extracted motifs and
amplitude heatmaps</li>
</ol>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lxiao06.github.io/ASAP/">ASAP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get path to example WAV file included with the package</span></span>
<span><span class="va">wav_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"zf_example.wav"</span>, package <span class="op">=</span> <span class="st">"ASAP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-song">1. Visualize the Song<a class="anchor" aria-label="anchor" href="#visualize-the-song"></a>
</h2>
<p>First, let’s look at the full recording to identify motif
structure:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/visualize-full-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
<p>We can see multiple motif renditions in this recording. Let’s zoom in
on a clear section to identify a good reference motif:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span>, </span>
<span>               start_time_in_second <span class="op">=</span> <span class="fl">1</span>, </span>
<span>               end_time_in_second <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/visualize-segment-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="create-an-audio-clip">2. Create an Audio Clip<a class="anchor" aria-label="anchor" href="#create-an-audio-clip"></a>
</h2>
<p>To create a template, we first extract an audio clip containing a
clear motif. We’ll use the segment from 1-2.5 seconds which contains a
complete motif.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an audio clip from the WAV file</span></span>
<span><span class="va">clip_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_audio_clip.html">create_audio_clip</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>                               start_time <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               end_time <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Song clip clip_zf_example.wav is generated.</span></span>
<span></span>
<span><span class="co"># View the created clip path</span></span>
<span><span class="va">clip_path</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/ASAP/extdata/templates/clip_zf_example.wav"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-template">3. Create a Template<a class="anchor" aria-label="anchor" href="#create-a-template"></a>
</h2>
<p>A template is a short audio segment of a distinctive syllable that
we’ll use to find motifs throughout the recording. We select a syllable
that: - Is acoustically distinctive - Occurs once per motif - Has clear
boundaries</p>
<p>Based on the spectrogram, we’ll use syllable “d” which occurs around
0.72-0.84 seconds within our clip.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, visualize the template region</span></span>
<span><span class="fu"><a href="../reference/visualize_song.html">visualize_song</a></span><span class="op">(</span><span class="va">wav_file</span>,</span>
<span>               start_time_in_second <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.72</span>,</span>
<span>               end_time_in_second <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.84</span><span class="op">)</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/create-template-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the template</span></span>
<span><span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_template.html">create_template</a></span><span class="op">(</span><span class="va">clip_path</span>,</span>
<span>                            template_name <span class="op">=</span> <span class="st">"d"</span>,</span>
<span>                            start_time <span class="op">=</span> <span class="fl">0.72</span>,</span>
<span>                            end_time <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>                            freq_min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            freq_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                            write_template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/make-template-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Automatic point selection.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done.</span></span>
<span></span>
<span><span class="co"># View template info</span></span>
<span><span class="va">template</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Object of class "corTemplateList"</span></span>
<span><span class="co">#&gt;  containing  1  templates</span></span>
<span><span class="co">#&gt;                                                           original.recording</span></span>
<span><span class="co">#&gt; d /home/runner/work/_temp/Library/ASAP/extdata/templates/clip_zf_example.wav</span></span>
<span><span class="co">#&gt;   sample.rate lower.frequency upper.frequency lower.amp upper.amp duration</span></span>
<span><span class="co">#&gt; d       44100           1.034           9.991    -80.41         0    0.104</span></span>
<span><span class="co">#&gt;   n.points score.cutoff</span></span>
<span><span class="co">#&gt; d     1050          0.6</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="detect-template-occurrences">4. Detect Template Occurrences<a class="anchor" aria-label="anchor" href="#detect-template-occurrences"></a>
</h2>
<p>Now we search for all occurrences of this template throughout the
recording:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run template detection on the original WAV file</span></span>
<span><span class="va">template_matches</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_template.html">detect_template</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wav_file</span>,</span>
<span>                                    template <span class="op">=</span> <span class="va">template</span>,</span>
<span>                                    save_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View detection results</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">template_matches</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">filename</th>
<th align="left">template</th>
<th align="right">time</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="left">d</td>
<td align="right">1.76</td>
<td align="right">0.93</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="left">d</td>
<td align="right">3.07</td>
<td align="right">0.77</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="left">d</td>
<td align="right">4.66</td>
<td align="right">0.79</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="extract-motif-boundaries">5. Extract Motif Boundaries<a class="anchor" aria-label="anchor" href="#extract-motif-boundaries"></a>
</h2>
<p>Once we have template detections, we define motif boundaries by
extending a fixed time window before and after each detection:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define motif boundaries around each detection</span></span>
<span><span class="co"># pre_time: how much before the template to include</span></span>
<span><span class="co"># lag_time: how much after the template to include</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_motif.html">find_motif</a></span><span class="op">(</span><span class="va">template_matches</span>,</span>
<span>                     pre_time <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                     lag_time <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                     wav_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Processed zf_example.wav: 3/3 valid motifs (0 excluded)</span></span>
<span><span class="co">#&gt; Total valid motifs found: 3 (excluded: 0)</span></span>
<span></span>
<span><span class="co"># View extracted motifs</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">motifs</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">filename</th>
<th align="right">detection_time</th>
<th align="right">start_time</th>
<th align="right">end_time</th>
<th align="right">duration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">1.76</td>
<td align="right">1.06</td>
<td align="right">2.26</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="left">zf_example.wav</td>
<td align="right">3.07</td>
<td align="right">2.37</td>
<td align="right">3.57</td>
<td align="right">1.2</td>
</tr>
<tr class="odd">
<td align="left">zf_example.wav</td>
<td align="right">4.66</td>
<td align="right">3.96</td>
<td align="right">5.16</td>
<td align="right">1.2</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="visualize-detected-motifs">6. Visualize Detected Motifs<a class="anchor" aria-label="anchor" href="#visualize-detected-motifs"></a>
</h2>
<p>Let’s visualize the detected motifs to verify our detection worked
correctly:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize all extracted motifs</span></span>
<span><span class="fu"><a href="../reference/visualize_segments.html">visualize_segments</a></span><span class="op">(</span><span class="va">motifs</span>, </span>
<span>                   wav_file_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span>,</span>
<span>                   n_samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">motifs</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span>
<span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/visualize-motifs-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; Song visualization completed for: zf_example.wav</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="amplitude-envelope-heatmap">7. Amplitude Envelope Heatmap<a class="anchor" aria-label="anchor" href="#amplitude-envelope-heatmap"></a>
</h2>
<p>We can create a heatmap of amplitude envelopes across all detected
motifs to see the temporal structure:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot amplitude envelope heatmap</span></span>
<span><span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span><span class="va">motifs</span>, wav_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">wav_file</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="motif_detection_files/figure-html/plot-heatmap-1.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; $segments</span></span>
<span><span class="co">#&gt;         filename detection_time start_time end_time duration</span></span>
<span><span class="co">#&gt; 1 zf_example.wav           1.76       1.06     2.26      1.2</span></span>
<span><span class="co">#&gt; 2 zf_example.wav           3.07       2.37     3.57      1.2</span></span>
<span><span class="co">#&gt; 3 zf_example.wav           4.66       3.96     5.16      1.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $amp_matrix</span></span>
<span><span class="co">#&gt;              [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt;   [1,]   420.4235  5170.0441   477.4549</span></span>
<span><span class="co">#&gt;   [2,]   766.0234  6001.7781   570.0138</span></span>
<span><span class="co">#&gt;   [3,]  1851.5875  7273.0453   587.9995</span></span>
<span><span class="co">#&gt;   [4,]  3171.2584  6868.2642   659.9688</span></span>
<span><span class="co">#&gt;   [5,]  4205.8270  6154.4299   712.4466</span></span>
<span><span class="co">#&gt;   [6,]  5082.0313  6508.8673   552.3837</span></span>
<span><span class="co">#&gt;   [7,]  5386.4478  6631.4315   426.6732</span></span>
<span><span class="co">#&gt;   [8,]  5174.1381  6281.5218   411.9632</span></span>
<span><span class="co">#&gt;   [9,]  4620.2017  6951.8561   498.1689</span></span>
<span><span class="co">#&gt;  [10,]  4322.9043  6628.4913   707.9908</span></span>
<span><span class="co">#&gt;  [11,]  4789.0324  5508.4086   777.1376</span></span>
<span><span class="co">#&gt;  [12,]  5150.0940  5297.8078   720.4037</span></span>
<span><span class="co">#&gt;  [13,]  4473.4925  4864.7951   642.1010</span></span>
<span><span class="co">#&gt;  [14,]  3912.8987  4761.6146   439.5518</span></span>
<span><span class="co">#&gt;  [15,]  3270.2737  5186.6531   276.8625</span></span>
<span><span class="co">#&gt;  [16,]  2740.5197  5249.6739   291.3494</span></span>
<span><span class="co">#&gt;  [17,]  2613.1007  4975.2120   359.2096</span></span>
<span><span class="co">#&gt;  [18,]  2267.7641  4903.7513   461.8464</span></span>
<span><span class="co">#&gt;  [19,]  2679.0838  5061.1655   485.1692</span></span>
<span><span class="co">#&gt;  [20,]  2844.2393  5208.7089   357.0840</span></span>
<span><span class="co">#&gt;  [21,]  2561.5500  5301.5606   341.1989</span></span>
<span><span class="co">#&gt;  [22,]  2434.6875  5748.9209   381.7455</span></span>
<span><span class="co">#&gt;  [23,]  2153.1904  7185.7204   331.2622</span></span>
<span><span class="co">#&gt;  [24,]  1761.5590  8763.8088   291.7937</span></span>
<span><span class="co">#&gt;  [25,]  1556.3222  9327.1989   226.8224</span></span>
<span><span class="co">#&gt;  [26,]  1513.0970  8702.8710   248.9714</span></span>
<span><span class="co">#&gt;  [27,]  1466.5013  7208.8861   388.9971</span></span>
<span><span class="co">#&gt;  [28,]  1201.2390  5996.0605   450.7887</span></span>
<span><span class="co">#&gt;  [29,]   979.1545  6176.8175   385.6461</span></span>
<span><span class="co">#&gt;  [30,]  1150.6668  8740.4340   296.6887</span></span>
<span><span class="co">#&gt;  [31,]  1139.3795 12137.2051   281.8417</span></span>
<span><span class="co">#&gt;  [32,]   947.4336 14387.8961   318.6748</span></span>
<span><span class="co">#&gt;  [33,]  1162.3852 14799.0288   433.7296</span></span>
<span><span class="co">#&gt;  [34,]  1796.3372 13727.7751   649.8827</span></span>
<span><span class="co">#&gt;  [35,]  2459.9208 12550.2679   753.8977</span></span>
<span><span class="co">#&gt;  [36,]  3351.5003 12870.5873   753.3210</span></span>
<span><span class="co">#&gt;  [37,]  4043.4681 12314.7325   796.1495</span></span>
<span><span class="co">#&gt;  [38,]  4057.8511 10015.2600   567.5953</span></span>
<span><span class="co">#&gt;  [39,]  4208.0337  9158.1421   382.8705</span></span>
<span><span class="co">#&gt;  [40,]  4695.0433  8853.8812   340.1073</span></span>
<span><span class="co">#&gt;  [41,]  4624.1299  9641.5298   266.7603</span></span>
<span><span class="co">#&gt;  [42,]  4651.0482 12068.1422   320.9803</span></span>
<span><span class="co">#&gt;  [43,]  4755.2473 12350.3624   332.7356</span></span>
<span><span class="co">#&gt;  [44,]  4929.7400 10360.2507   369.5650</span></span>
<span><span class="co">#&gt;  [45,]  4606.9466  9431.3829   617.7354</span></span>
<span><span class="co">#&gt;  [46,]  3458.5639  9707.5396   779.0295</span></span>
<span><span class="co">#&gt;  [47,]  3411.8349  9196.5591   685.9848</span></span>
<span><span class="co">#&gt;  [48,]  3186.9976  7119.1749   618.7510</span></span>
<span><span class="co">#&gt;  [49,]  2516.3152  5592.5209   559.3872</span></span>
<span><span class="co">#&gt;  [50,]  2065.3670  6113.0227   559.0951</span></span>
<span><span class="co">#&gt;  [51,]  1686.4647  5752.4135   574.4639</span></span>
<span><span class="co">#&gt;  [52,]  1619.9517  4813.4246   480.2953</span></span>
<span><span class="co">#&gt;  [53,]  1416.8459  4020.3862   393.6709</span></span>
<span><span class="co">#&gt;  [54,]  1264.3886  3102.1352   303.8993</span></span>
<span><span class="co">#&gt;  [55,]  1102.1970  3009.4032   235.6171</span></span>
<span><span class="co">#&gt;  [56,]   910.7857  2621.7818   219.5623</span></span>
<span><span class="co">#&gt;  [57,]   968.6845  2087.4305   239.4301</span></span>
<span><span class="co">#&gt;  [58,]   915.1239  1753.0055   340.1090</span></span>
<span><span class="co">#&gt;  [59,]   750.2236  1505.0600   375.3831</span></span>
<span><span class="co">#&gt;  [60,]   651.0535  1671.4550   371.9127</span></span>
<span><span class="co">#&gt;  [61,]   715.6757  1620.0426   370.1469</span></span>
<span><span class="co">#&gt;  [62,]   714.3262  1459.2751   274.2244</span></span>
<span><span class="co">#&gt;  [63,]   726.0353  1455.3966   297.6553</span></span>
<span><span class="co">#&gt;  [64,]   878.9161  1320.7955   499.2896</span></span>
<span><span class="co">#&gt;  [65,]   937.0714  1012.2114   611.9069</span></span>
<span><span class="co">#&gt;  [66,]   767.9197   809.0144   499.4473</span></span>
<span><span class="co">#&gt;  [67,]   608.1133   748.5195   397.7621</span></span>
<span><span class="co">#&gt;  [68,]   676.1052   595.1305   409.7401</span></span>
<span><span class="co">#&gt;  [69,]   901.6453   452.4039   384.3636</span></span>
<span><span class="co">#&gt;  [70,]  1423.8110   434.7919   405.7590</span></span>
<span><span class="co">#&gt;  [71,]  2417.8438   453.1548   801.0856</span></span>
<span><span class="co">#&gt;  [72,]  3388.8601   515.7392  1828.6584</span></span>
<span><span class="co">#&gt;  [73,]  3908.1169   722.7610  3494.4924</span></span>
<span><span class="co">#&gt;  [74,]  4257.6449   927.8750  4737.0363</span></span>
<span><span class="co">#&gt;  [75,]  4726.4243  1305.1577  5837.5815</span></span>
<span><span class="co">#&gt;  [76,]  5082.2210  1631.7300  7042.0451</span></span>
<span><span class="co">#&gt;  [77,]  5154.7184  1623.7673  7983.9397</span></span>
<span><span class="co">#&gt;  [78,]  5041.2578  1574.8951  9090.6194</span></span>
<span><span class="co">#&gt;  [79,]  5639.6043  1637.0415  8611.3334</span></span>
<span><span class="co">#&gt;  [80,]  5847.6731  1780.0443  6231.2643</span></span>
<span><span class="co">#&gt;  [81,]  5029.1039  1553.1044  6772.1450</span></span>
<span><span class="co">#&gt;  [82,]  4386.4159  1283.5457  7026.5478</span></span>
<span><span class="co">#&gt;  [83,]  3701.3716  1229.2967  5470.9579</span></span>
<span><span class="co">#&gt;  [84,]  3114.0686  1153.9815  5138.0367</span></span>
<span><span class="co">#&gt;  [85,]  2552.7404  1023.8073  4471.4011</span></span>
<span><span class="co">#&gt;  [86,]  1929.2276   822.2005  3955.0594</span></span>
<span><span class="co">#&gt;  [87,]  1687.0824   776.6861  3203.4142</span></span>
<span><span class="co">#&gt;  [88,]  1781.9563   711.5948  2569.5306</span></span>
<span><span class="co">#&gt;  [89,]  1611.5317   586.4697  2365.6774</span></span>
<span><span class="co">#&gt;  [90,]  1458.1767   583.5234  2357.3429</span></span>
<span><span class="co">#&gt;  [91,]  1221.2778   532.9593  2145.6909</span></span>
<span><span class="co">#&gt;  [92,]  1126.9542   445.7018  1599.2328</span></span>
<span><span class="co">#&gt;  [93,]   995.7153   414.7131  1451.5757</span></span>
<span><span class="co">#&gt;  [94,]   736.8650   366.2853  1277.0001</span></span>
<span><span class="co">#&gt;  [95,]   757.8986   381.7645   966.3496</span></span>
<span><span class="co">#&gt;  [96,]   716.8973   489.2095   916.9493</span></span>
<span><span class="co">#&gt;  [97,]   760.6081   474.3863   808.0637</span></span>
<span><span class="co">#&gt;  [98,]   867.2466   380.5210   651.9544</span></span>
<span><span class="co">#&gt;  [99,]   769.2190   305.4972   566.6546</span></span>
<span><span class="co">#&gt; [100,]   676.5666   311.0668   551.2234</span></span>
<span><span class="co">#&gt; [101,]   824.9975   440.1597   596.3784</span></span>
<span><span class="co">#&gt; [102,]   918.1473   617.2195   796.3573</span></span>
<span><span class="co">#&gt; [103,]  1057.6562  1079.8723  1271.0136</span></span>
<span><span class="co">#&gt; [104,]  1638.3650  2421.2801  2147.7070</span></span>
<span><span class="co">#&gt; [105,]  2514.5329  3906.3973  3742.5173</span></span>
<span><span class="co">#&gt; [106,]  3250.6823  4896.8574  6044.1637</span></span>
<span><span class="co">#&gt; [107,]  4090.9159  5849.0920  7971.4641</span></span>
<span><span class="co">#&gt; [108,]  4917.9773  6462.3542  8988.4603</span></span>
<span><span class="co">#&gt; [109,]  5040.6770  6723.8047  9253.8052</span></span>
<span><span class="co">#&gt; [110,]  5609.5241  8356.2999  8112.9793</span></span>
<span><span class="co">#&gt; [111,]  5524.8169  9974.0878  8321.0980</span></span>
<span><span class="co">#&gt; [112,]  4762.7284  9447.7207  9610.6479</span></span>
<span><span class="co">#&gt; [113,]  5179.8693  8627.8574  8920.3684</span></span>
<span><span class="co">#&gt; [114,]  6070.4180  8609.0561  7157.4212</span></span>
<span><span class="co">#&gt; [115,]  6075.2645  7449.7280  6153.6508</span></span>
<span><span class="co">#&gt; [116,]  4910.3575  6438.8388  5895.4072</span></span>
<span><span class="co">#&gt; [117,]  4281.8765  5629.1879  5869.3103</span></span>
<span><span class="co">#&gt; [118,]  3766.4119  3969.1187  5209.0271</span></span>
<span><span class="co">#&gt; [119,]  2821.5977  3730.4034  4298.0746</span></span>
<span><span class="co">#&gt; [120,]  2518.2612  4034.7232  3814.4452</span></span>
<span><span class="co">#&gt; [121,]  2357.6569  3501.7683  3327.1541</span></span>
<span><span class="co">#&gt; [122,]  1872.4629  2689.8932  2892.2642</span></span>
<span><span class="co">#&gt; [123,]  1727.2717  2477.5949  2277.5841</span></span>
<span><span class="co">#&gt; [124,]  1585.5863  2267.7271  2237.5970</span></span>
<span><span class="co">#&gt; [125,]  1379.0220  2117.2150  2357.6558</span></span>
<span><span class="co">#&gt; [126,]  1182.8086  1708.8090  1911.5163</span></span>
<span><span class="co">#&gt; [127,]  1064.2902  1265.1348  1577.5829</span></span>
<span><span class="co">#&gt; [128,]   922.7311  1246.3867  1518.4384</span></span>
<span><span class="co">#&gt; [129,]   709.7519  1226.9131  1231.3467</span></span>
<span><span class="co">#&gt; [130,]   701.6761  1095.2505   871.0031</span></span>
<span><span class="co">#&gt; [131,]   656.9139   944.3306   932.5645</span></span>
<span><span class="co">#&gt; [132,]   721.5257  1141.0285  3466.5362</span></span>
<span><span class="co">#&gt; [133,]   778.6015  3469.9620  6795.3600</span></span>
<span><span class="co">#&gt; [134,]   900.8846  6139.5429 11017.1861</span></span>
<span><span class="co">#&gt; [135,]  1887.5852  8404.8989 14375.9834</span></span>
<span><span class="co">#&gt; [136,]  4509.7746 11167.3791 14401.2439</span></span>
<span><span class="co">#&gt; [137,]  8034.2268 13691.5965 13979.8602</span></span>
<span><span class="co">#&gt; [138,] 10763.2947 14057.0035 15144.4218</span></span>
<span><span class="co">#&gt; [139,] 12825.0229 15380.9400 16647.0478</span></span>
<span><span class="co">#&gt; [140,] 13658.0120 16676.0619 17906.6450</span></span>
<span><span class="co">#&gt; [141,] 14014.1740 16761.3419 19905.6609</span></span>
<span><span class="co">#&gt; [142,] 15455.5288 16887.3158 17179.6604</span></span>
<span><span class="co">#&gt; [143,] 16120.2962 17219.4543 13287.5943</span></span>
<span><span class="co">#&gt; [144,] 15420.4670 18348.3639 11460.3913</span></span>
<span><span class="co">#&gt; [145,] 14503.2582 18071.8571 11102.4009</span></span>
<span><span class="co">#&gt; [146,] 15217.1252 16570.5285 12289.2653</span></span>
<span><span class="co">#&gt; [147,] 15828.7024 13304.9973  9576.0217</span></span>
<span><span class="co">#&gt; [148,] 13393.4447  9908.1458  6843.9196</span></span>
<span><span class="co">#&gt; [149,] 13291.4466  8884.3214  5914.3484</span></span>
<span><span class="co">#&gt; [150,] 12634.6302  8014.6797  6040.1003</span></span>
<span><span class="co">#&gt; [151,]  9192.0229  6777.7249  5727.5018</span></span>
<span><span class="co">#&gt; [152,]  7890.6087  5881.0112  4298.4895</span></span>
<span><span class="co">#&gt; [153,]  7035.8930  4944.5037  3973.0616</span></span>
<span><span class="co">#&gt; [154,]  5967.6180  5466.0761  3326.0631</span></span>
<span><span class="co">#&gt; [155,]  5265.1238  4603.2753  3323.6290</span></span>
<span><span class="co">#&gt; [156,]  4967.4407  3400.5232  3199.7173</span></span>
<span><span class="co">#&gt; [157,]  4177.9604  3359.3120  2265.2949</span></span>
<span><span class="co">#&gt; [158,]  3582.3731  2926.2743  1805.6193</span></span>
<span><span class="co">#&gt; [159,]  3353.4285  2442.3009  1804.7858</span></span>
<span><span class="co">#&gt; [160,]  2949.4013  2148.0205  1572.8144</span></span>
<span><span class="co">#&gt; [161,]  2381.2337  1833.6471  1561.7921</span></span>
<span><span class="co">#&gt; [162,]  2009.4135  1427.4104  1394.1892</span></span>
<span><span class="co">#&gt; [163,]  1986.8388  1128.2123  1052.2817</span></span>
<span><span class="co">#&gt; [164,]  1656.9715  1110.8077  1006.6007</span></span>
<span><span class="co">#&gt; [165,]  1292.4469   927.7957  1059.5759</span></span>
<span><span class="co">#&gt; [166,]  1228.2172   985.8589  1169.1622</span></span>
<span><span class="co">#&gt; [167,]  1169.0079  1190.7429  1342.3276</span></span>
<span><span class="co">#&gt; [168,]   994.1725  1221.6123  1579.8919</span></span>
<span><span class="co">#&gt; [169,]  1025.9753  1626.4396  2035.2715</span></span>
<span><span class="co">#&gt; [170,]  1231.5664  2088.6982  2452.5201</span></span>
<span><span class="co">#&gt; [171,]  1516.1435  2465.4991  3168.7858</span></span>
<span><span class="co">#&gt; [172,]  1736.8937  3186.2169  3809.0626</span></span>
<span><span class="co">#&gt; [173,]  1720.7847  4891.6724  3927.9462</span></span>
<span><span class="co">#&gt; [174,]  1995.0967  4563.9953  3779.5371</span></span>
<span><span class="co">#&gt; [175,]  2569.7088  3645.9585  3862.1281</span></span>
<span><span class="co">#&gt; [176,]  3724.6765  4187.9170  4455.0749</span></span>
<span><span class="co">#&gt; [177,]  4294.0483  5218.8786  4006.1188</span></span>
<span><span class="co">#&gt; [178,]  4359.0626  7002.1068  3385.1159</span></span>
<span><span class="co">#&gt; [179,]  5526.5771  6573.5936  3154.4576</span></span>
<span><span class="co">#&gt; [180,]  6164.0941  4952.1639  2881.8317</span></span>
<span><span class="co">#&gt; [181,]  5764.7985  3546.8647  2503.4198</span></span>
<span><span class="co">#&gt; [182,]  4637.5490  2441.8029  2110.5282</span></span>
<span><span class="co">#&gt; [183,]  3705.8091  2324.4942  2059.6740</span></span>
<span><span class="co">#&gt; [184,]  2926.4581  2213.3385  1949.5517</span></span>
<span><span class="co">#&gt; [185,]  2282.1531  1815.8149  1607.9932</span></span>
<span><span class="co">#&gt; [186,]  2306.7651  1771.9257  1505.4462</span></span>
<span><span class="co">#&gt; [187,]  1881.9581  1909.0230  1615.4883</span></span>
<span><span class="co">#&gt; [188,]  1682.2873  1798.4262  1321.7186</span></span>
<span><span class="co">#&gt; [189,]  1675.9300  1378.1992  1093.8768</span></span>
<span><span class="co">#&gt; [190,]  1459.3951  1107.1843  1047.0782</span></span>
<span><span class="co">#&gt; [191,]  1374.9128  1044.2384   884.4137</span></span>
<span><span class="co">#&gt; [192,]  1177.1672  1067.0437  2075.9685</span></span>
<span><span class="co">#&gt; [193,]  1081.5277   931.1792 11495.2361</span></span>
<span><span class="co">#&gt; [194,]  1009.0391  5400.4068 22210.5361</span></span>
<span><span class="co">#&gt; [195,]   716.9375 16682.5722 18750.2263</span></span>
<span><span class="co">#&gt; [196,]   758.9008 22126.4292 13835.2478</span></span>
<span><span class="co">#&gt; [197,]  4867.9243 19894.1275 13332.9648</span></span>
<span><span class="co">#&gt; [198,] 12842.8683 14747.6984 14329.1464</span></span>
<span><span class="co">#&gt; [199,] 11681.7383 10169.1637 14918.3224</span></span>
<span><span class="co">#&gt; [200,]  9427.7033 11134.1119 15009.0418</span></span>
<span><span class="co">#&gt; [201,]  9796.1099 11222.5369 12631.3213</span></span>
<span><span class="co">#&gt; [202,] 12418.9754 13403.9121 11331.6170</span></span>
<span><span class="co">#&gt; [203,] 15226.7380 13275.5584 12105.2798</span></span>
<span><span class="co">#&gt; [204,] 12825.4517 11082.0147  9592.6892</span></span>
<span><span class="co">#&gt; [205,] 12805.6280 11724.4731  8866.1051</span></span>
<span><span class="co">#&gt; [206,] 10658.6238 11066.3427  8212.3737</span></span>
<span><span class="co">#&gt; [207,]  8043.4302  9177.4803  7754.0793</span></span>
<span><span class="co">#&gt; [208,]  8178.3412  9462.9655  6320.4594</span></span>
<span><span class="co">#&gt; [209,]  9638.5674  8831.2220  5309.0508</span></span>
<span><span class="co">#&gt; [210,]  8971.3896  7172.8410  5089.5682</span></span>
<span><span class="co">#&gt; [211,]  8144.1350  6741.8821  3992.8843</span></span>
<span><span class="co">#&gt; [212,]  6953.3877  4638.8654  3306.7598</span></span>
<span><span class="co">#&gt; [213,]  5794.3573  4111.4505  6695.0115</span></span>
<span><span class="co">#&gt; [214,]  5425.1203  3808.3442  7636.9012</span></span>
<span><span class="co">#&gt; [215,]  3847.4858  6897.7537  5432.4718</span></span>
<span><span class="co">#&gt; [216,]  4464.5884  8466.1050  5742.8923</span></span>
<span><span class="co">#&gt; [217,]  7885.7086  5448.6389  5448.9138</span></span>
<span><span class="co">#&gt; [218,]  7315.8189  5345.7005  3886.3734</span></span>
<span><span class="co">#&gt; [219,]  6246.6547  5356.2181  3194.9503</span></span>
<span><span class="co">#&gt; [220,]  6392.0844  3662.0420  3373.6548</span></span>
<span><span class="co">#&gt; [221,]  5203.3712  3053.5807  2848.4083</span></span>
<span><span class="co">#&gt; [222,]  5362.9809  3261.0129  2864.3515</span></span>
<span><span class="co">#&gt; [223,]  4140.5687  2642.8874  4003.7598</span></span>
<span><span class="co">#&gt; [224,]  3602.2022  2927.6687  4361.9469</span></span>
<span><span class="co">#&gt; [225,]  3814.0182  3665.3937  5166.1145</span></span>
<span><span class="co">#&gt; [226,]  3549.7871  4033.4590  6642.5182</span></span>
<span><span class="co">#&gt; [227,]  4197.7600  4356.1667  6363.0435</span></span>
<span><span class="co">#&gt; [228,]  5203.8019  5250.2306  4943.9307</span></span>
<span><span class="co">#&gt; [229,]  5885.2881  5198.6498  4697.6699</span></span>
<span><span class="co">#&gt; [230,]  6546.5037  4861.7570  4530.0239</span></span>
<span><span class="co">#&gt; [231,]  5905.4236  5958.8350  4147.4782</span></span>
<span><span class="co">#&gt; [232,]  5928.1832  6808.1311  5559.6537</span></span>
<span><span class="co">#&gt; [233,]  6893.0620  6183.9238  6613.9964</span></span>
<span><span class="co">#&gt; [234,]  6106.8262  5573.5393  6770.1907</span></span>
<span><span class="co">#&gt; [235,]  5378.7832  6576.5219  6260.7599</span></span>
<span><span class="co">#&gt; [236,]  6042.9436  5822.2412  5894.2032</span></span>
<span><span class="co">#&gt; [237,]  7596.5974  5378.5353  7332.0131</span></span>
<span><span class="co">#&gt; [238,]  7220.2755  6258.7569  6020.4713</span></span>
<span><span class="co">#&gt; [239,]  6100.3463  5583.1153  4329.4334</span></span>
<span><span class="co">#&gt; [240,]  5525.1869  4925.4920  4663.5504</span></span>
<span><span class="co">#&gt; [241,]  4445.0152  5085.2872  4449.1713</span></span>
<span><span class="co">#&gt; [242,]  5569.7520  5429.2247  5244.5624</span></span>
<span><span class="co">#&gt; [243,]  6952.8960  6313.0366  5153.2555</span></span>
<span><span class="co">#&gt; [244,]  6731.8623  7091.6064  5099.6540</span></span>
<span><span class="co">#&gt; [245,]  5968.1268  8641.8970  5587.1014</span></span>
<span><span class="co">#&gt; [246,]  4886.7872 10018.9953  8003.9521</span></span>
<span><span class="co">#&gt; [247,]  4631.2185  8923.8402 10080.3026</span></span>
<span><span class="co">#&gt; [248,]  5633.5115  9580.0648 11680.7934</span></span>
<span><span class="co">#&gt; [249,]  6165.9996 11682.2516 12847.7885</span></span>
<span><span class="co">#&gt; [250,]  6215.1984 12914.0907 10353.0821</span></span>
<span><span class="co">#&gt; [251,]  7724.4594 11093.3748  8261.9073</span></span>
<span><span class="co">#&gt; [252,]  9630.6089  7809.8390  7754.2734</span></span>
<span><span class="co">#&gt; [253,]  8874.0690  6415.8307  7007.1955</span></span>
<span><span class="co">#&gt; [254,]  7460.6720  6352.7119  5414.2877</span></span>
<span><span class="co">#&gt; [255,]  6736.8558  6557.8972  4914.4653</span></span>
<span><span class="co">#&gt; [256,]  6360.9198  5961.7310  4889.6321</span></span>
<span><span class="co">#&gt; [257,]  5544.2987  5033.8400  4750.7837</span></span>
<span><span class="co">#&gt; [258,]  4512.8179  3952.7447  5644.0469</span></span>
<span><span class="co">#&gt; [259,]  4160.8169  4765.9348  5102.4103</span></span>
<span><span class="co">#&gt; [260,]  4526.2062  6009.1104  4106.0462</span></span>
<span><span class="co">#&gt; [261,]  5070.9603  5497.6539  3728.2752</span></span>
<span><span class="co">#&gt; [262,]  5739.0237  4573.0053  3047.5992</span></span>
<span><span class="co">#&gt; [263,]  5095.5865  4051.8445  2730.4499</span></span>
<span><span class="co">#&gt; [264,]  4124.2163  3638.1334  2437.5788</span></span>
<span><span class="co">#&gt; [265,]  4024.5750  3007.3129  2119.6778</span></span>
<span><span class="co">#&gt; [266,]  3604.2088  2675.2899  2009.3727</span></span>
<span><span class="co">#&gt; [267,]  3059.7190  2276.9301  1694.6792</span></span>
<span><span class="co">#&gt; [268,]  2392.2689  1942.1754  1409.0192</span></span>
<span><span class="co">#&gt; [269,]  1948.2632  1839.7097  1399.0887</span></span>
<span><span class="co">#&gt; [270,]  1623.3526  1724.7788  1224.7740</span></span>
<span><span class="co">#&gt; [271,]  1488.5955  1349.5512  1033.8677</span></span>
<span><span class="co">#&gt; [272,]  1278.5635   951.1320  1045.6994</span></span>
<span><span class="co">#&gt; [273,]  1230.7975   973.1869  1035.6263</span></span>
<span><span class="co">#&gt; [274,]  1254.3125   970.7841  1034.4548</span></span>
<span><span class="co">#&gt; [275,]  1059.9551   727.8713  1030.9641</span></span>
<span><span class="co">#&gt; [276,]   810.3014   693.9194   985.3065</span></span>
<span><span class="co">#&gt; [277,]   647.4080   744.0448  1212.8590</span></span>
<span><span class="co">#&gt; [278,]   556.0885   769.2560  3244.6609</span></span>
<span><span class="co">#&gt; [279,]   537.2443   867.5312  5405.7146</span></span>
<span><span class="co">#&gt; [280,]   578.2857  2609.9606  6258.3372</span></span>
<span><span class="co">#&gt; [281,]   616.0897  5179.6888  7213.9325</span></span>
<span><span class="co">#&gt; [282,]  2406.0366  6248.4772  7486.4015</span></span>
<span><span class="co">#&gt; [283,]  4751.0098  6401.7396  6708.4358</span></span>
<span><span class="co">#&gt; [284,]  5815.8816  5621.9568  6427.9305</span></span>
<span><span class="co">#&gt; [285,]  5971.4164  5016.2590  6779.7337</span></span>
<span><span class="co">#&gt; [286,]  4833.5356  4907.9294  6687.5478</span></span>
<span><span class="co">#&gt; [287,]  4793.8244  5398.2011  6906.4476</span></span>
<span><span class="co">#&gt; [288,]  5016.9789  5585.8689  7657.9768</span></span>
<span><span class="co">#&gt; [289,]  6111.7980  4765.3009  7873.1525</span></span>
<span><span class="co">#&gt; [290,]  7726.5778  5541.2213  7694.6585</span></span>
<span><span class="co">#&gt; [291,]  7053.3571  6263.2939  7106.8432</span></span>
<span><span class="co">#&gt; [292,]  5997.9041  5591.1589  6908.9600</span></span>
<span><span class="co">#&gt; [293,]  5299.3160  5154.3989  7523.0926</span></span>
<span><span class="co">#&gt; [294,]  4751.0992  5942.5908  6947.4731</span></span>
<span><span class="co">#&gt; [295,]  4953.7001  6539.4662  6243.1293</span></span>
<span><span class="co">#&gt; [296,]  5198.3688  6719.0651  5650.2914</span></span>
<span><span class="co">#&gt; [297,]  5084.0112  7026.3662  5656.8394</span></span>
<span><span class="co">#&gt; [298,]  5377.4708  7344.6710  6154.9163</span></span>
<span><span class="co">#&gt; [299,]  5869.5278  7254.6622  6820.5397</span></span>
<span><span class="co">#&gt; [300,]  5612.6318  7661.8449  6674.5475</span></span>
<span><span class="co">#&gt; [301,]  5499.1579  7460.8677  6201.0010</span></span>
<span><span class="co">#&gt; [302,]  6894.8649  6153.0212  6313.5493</span></span>
<span><span class="co">#&gt; [303,]  7651.7333  6165.2326  7280.4451</span></span>
<span><span class="co">#&gt; [304,]  7493.3080  6254.5805  7634.7720</span></span>
<span><span class="co">#&gt; [305,]  7798.2381  6223.3720  5607.3678</span></span>
<span><span class="co">#&gt; [306,]  7374.8545  6282.4432  4274.0625</span></span>
<span><span class="co">#&gt; [307,]  5942.6455  5923.5966  4020.6415</span></span>
<span><span class="co">#&gt; [308,]  4625.3134  5230.4878  3712.0957</span></span>
<span><span class="co">#&gt; [309,]  4362.6603  4677.0060  2790.4258</span></span>
<span><span class="co">#&gt; [310,]  4193.2800  4384.1030  2384.0156</span></span>
<span><span class="co">#&gt; [311,]  3061.7387  3228.0904  2286.8444</span></span>
<span><span class="co">#&gt; [312,]  2523.8597  1795.3563  1890.3898</span></span>
<span><span class="co">#&gt; [313,]  2325.5202  1446.2061  1648.8224</span></span>
<span><span class="co">#&gt; [314,]  2175.5098  1680.8321  1399.3007</span></span>
<span><span class="co">#&gt; [315,]  2282.5236  1811.7836  1033.8704</span></span>
<span><span class="co">#&gt; [316,]  2399.5523  1612.5493   853.4858</span></span>
<span><span class="co">#&gt; [317,]  2203.7234  1394.7161   791.9332</span></span>
<span><span class="co">#&gt; [318,]  1833.1046  1105.2009   810.0338</span></span>
<span><span class="co">#&gt; [319,]  1500.8502   924.4784  1001.6902</span></span>
<span><span class="co">#&gt; [320,]  1305.0025  1040.0847  1235.3503</span></span>
<span><span class="co">#&gt; [321,]  1184.7486  1292.2620  1431.7778</span></span>
<span><span class="co">#&gt; [322,]  1266.5534  1496.6761  1488.1889</span></span>
<span><span class="co">#&gt; [323,]  1632.4483  1771.7387  1392.5889</span></span>
<span><span class="co">#&gt; [324,]  1827.8950  1922.7893  1447.8190</span></span>
<span><span class="co">#&gt; [325,]  1762.5374  1835.0987  1521.0211</span></span>
<span><span class="co">#&gt; [326,]  1735.2331  1689.8136  1532.9961</span></span>
<span><span class="co">#&gt; [327,]  1933.6695  1635.9987  1675.5262</span></span>
<span><span class="co">#&gt; [328,]  2356.5090  1554.5064  1757.4948</span></span>
<span><span class="co">#&gt; [329,]  2696.0739  1473.5422  1626.3850</span></span>
<span><span class="co">#&gt; [330,]  2473.4349  1453.8048  1473.0649</span></span>
<span><span class="co">#&gt; [331,]  2252.2419  1353.9566  1397.0745</span></span>
<span><span class="co">#&gt; [332,]  2207.8429  1130.5950  1526.8206</span></span>
<span><span class="co">#&gt; [333,]  2130.9969  1151.4656  1616.3650</span></span>
<span><span class="co">#&gt; [334,]  1820.2967  1684.6563  1456.9355</span></span>
<span><span class="co">#&gt; [335,]  1543.7232  1659.8750  1460.1550</span></span>
<span><span class="co">#&gt; [336,]  1647.0069  1534.3861  1322.4000</span></span>
<span><span class="co">#&gt; [337,]  1602.1860  1633.2913  1101.8468</span></span>
<span><span class="co">#&gt; [338,]  1545.1268  1419.2525   856.3848</span></span>
<span><span class="co">#&gt; [339,]  1525.1100  1252.3367   641.4270</span></span>
<span><span class="co">#&gt; [340,]  1493.8161  1029.7047   645.3721</span></span>
<span><span class="co">#&gt; [341,]  1488.3321   814.6757   636.6743</span></span>
<span><span class="co">#&gt; [342,]  1245.6540   844.2370   627.9928</span></span>
<span><span class="co">#&gt; [343,]   978.5357   927.2005   619.3314</span></span>
<span><span class="co">#&gt; [344,]   796.6736   871.2073   470.0550</span></span>
<span><span class="co">#&gt; [345,]   640.1245   773.8725   337.0235</span></span>
<span><span class="co">#&gt; [346,]   593.3969   592.2641   306.5205</span></span>
<span><span class="co">#&gt; [347,]   554.9245   466.5942   344.0338</span></span>
<span><span class="co">#&gt; [348,]   491.4741   524.4842   431.6859</span></span>
<span><span class="co">#&gt; [349,]   543.7809   572.3143   413.3475</span></span>
<span><span class="co">#&gt; [350,]   575.8842   582.4246   322.6713</span></span>
<span><span class="co">#&gt; [351,]   569.9307   646.9918   286.4449</span></span>
<span><span class="co">#&gt; [352,]   499.3103   633.2643   284.7268</span></span>
<span><span class="co">#&gt; [353,]   357.5211   528.7701   262.4090</span></span>
<span><span class="co">#&gt; [354,]   263.3039  1920.7425   243.4138</span></span>
<span><span class="co">#&gt; [355,]   317.5878  4899.3678   290.9943</span></span>
<span><span class="co">#&gt; [356,]  1498.9597  6943.9864   307.2297</span></span>
<span><span class="co">#&gt; [357,]  3988.3118  7674.3305   318.5757</span></span>
<span><span class="co">#&gt; [358,]  6593.7533  7825.8680   393.4279</span></span>
<span><span class="co">#&gt; [359,]  6823.6098  8613.5544   414.9510</span></span>
<span><span class="co">#&gt; [360,]  7130.7398  8909.4224   364.7512</span></span>
<span><span class="co">#&gt; [361,]  8644.1423  8781.2626   245.0752</span></span>
<span><span class="co">#&gt; [362,]  9736.8722  9950.2290   164.5411</span></span>
<span><span class="co">#&gt; [363,] 12587.0395 10763.1100   249.6541</span></span>
<span><span class="co">#&gt; [364,] 14911.1591 11407.8910   428.5592</span></span>
<span><span class="co">#&gt; [365,] 12577.5930 10313.0804   557.4798</span></span>
<span><span class="co">#&gt; [366,]  9888.7310  8356.1891   564.4479</span></span>
<span><span class="co">#&gt; [367,] 10561.6366  8548.1864   463.5283</span></span>
<span><span class="co">#&gt; [368,] 10601.9166  9919.6273   332.2377</span></span>
<span><span class="co">#&gt; [369,] 10810.2473 10163.8565   291.5357</span></span>
<span><span class="co">#&gt; [370,] 10723.0691  8854.0596   297.5213</span></span>
<span><span class="co">#&gt; [371,] 10108.3190  7367.7676   266.1644</span></span>
<span><span class="co">#&gt; [372,]  9581.3491  6341.0551   227.5614</span></span>
<span><span class="co">#&gt; [373,]  8983.2730  5220.8907   217.8705</span></span>
<span><span class="co">#&gt; [374,]  8948.5542  4533.8902   261.4899</span></span>
<span><span class="co">#&gt; [375,]  9134.2130  5402.9117   344.9254</span></span>
<span><span class="co">#&gt; [376,] 10923.7589  6778.1678   452.1548</span></span>
<span><span class="co">#&gt; [377,] 13251.8227  7631.0300   543.7375</span></span>
<span><span class="co">#&gt; [378,] 13653.4997  7589.1982   514.7090</span></span>
<span><span class="co">#&gt; [379,] 12201.8513  6277.2426   400.6394</span></span>
<span><span class="co">#&gt; [380,] 11376.8029  5293.7480   338.5038</span></span>
<span><span class="co">#&gt; [381,] 10251.1372  5632.1413   365.2046</span></span>
<span><span class="co">#&gt; [382,]  9323.6422  6471.7156   437.6149</span></span>
<span><span class="co">#&gt; [383,]  9630.2198  7140.4526   491.6971</span></span>
<span><span class="co">#&gt; [384,]  9042.2956  7083.5924   572.9594</span></span>
<span><span class="co">#&gt; [385,]  9093.2542  7019.9064   612.8508</span></span>
<span><span class="co">#&gt; [386,]  9709.9503  7380.6520   575.9682</span></span>
<span><span class="co">#&gt; [387,]  9544.6866  6901.0981   562.9525</span></span>
<span><span class="co">#&gt; [388,]  9954.4284  6618.7901   536.3373</span></span>
<span><span class="co">#&gt; [389,]  9601.0912  6768.9681   404.5040</span></span>
<span><span class="co">#&gt; [390,]  8093.3802  6215.8168   312.6935</span></span>
<span><span class="co">#&gt; [391,]  6553.3957  5574.8703   303.4248</span></span>
<span><span class="co">#&gt; [392,]  4947.9492  4803.7981   419.0042</span></span>
<span><span class="co">#&gt; [393,]  3893.9392  4250.2657   586.3272</span></span>
<span><span class="co">#&gt; [394,]  3180.8081  4226.3640   576.6643</span></span>
<span><span class="co">#&gt; [395,]  2566.2276  3503.3207   564.9111</span></span>
<span><span class="co">#&gt; [396,]  2253.1982  2506.3859   527.9589</span></span>
<span><span class="co">#&gt; [397,]  2063.3982  2019.1271   443.3046</span></span>
<span><span class="co">#&gt; [398,]  1548.8141  1801.2521   488.1325</span></span>
<span><span class="co">#&gt; [399,]  1006.2056  1602.9484   521.3006</span></span>
<span><span class="co">#&gt; [400,]   897.3093  1669.1087   482.8534</span></span>
<span><span class="co">#&gt; [401,]   985.1697  1924.6515   480.8241</span></span>
<span><span class="co">#&gt; [402,]   946.2035  1512.6199   467.2644</span></span>
<span><span class="co">#&gt; [403,]   795.9628   909.0879   378.6720</span></span>
<span><span class="co">#&gt; [404,]   711.2289   720.2352   335.8911</span></span>
<span><span class="co">#&gt; [405,]   558.3021   841.9020   394.2853</span></span>
<span><span class="co">#&gt; [406,]   448.3070  1019.0299   461.0591</span></span>
<span><span class="co">#&gt; [407,]   564.2789  1104.0351   544.9649</span></span>
<span><span class="co">#&gt; [408,]   717.6662  1086.4952   536.5854</span></span>
<span><span class="co">#&gt; [409,]   714.9220  1030.8365   425.0494</span></span>
<span><span class="co">#&gt; [410,]   631.1442   850.9609   367.5607</span></span>
<span><span class="co">#&gt; [411,]   580.0322   690.8761   312.3424</span></span>
<span><span class="co">#&gt; [412,]   582.5930   601.2553   292.5952</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre>
<p><img src="motif_detection_files/figure-html/plot-heatmap-2.png" class="r-plt" alt="" width="100%"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "segment_heatmap" "list"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated the core ASAP workflow for finding
motifs:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="34%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Step</th>
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code><a href="../reference/visualize_song.html">visualize_song()</a></code></td>
<td>View spectrogram to identify motifs</td>
</tr>
<tr class="even">
<td>2</td>
<td><code><a href="../reference/create_audio_clip.html">create_audio_clip()</a></code></td>
<td>Extract a reference motif segment</td>
</tr>
<tr class="odd">
<td>3</td>
<td><code><a href="../reference/create_template.html">create_template()</a></code></td>
<td>Create a template from a distinctive syllable</td>
</tr>
<tr class="even">
<td>4</td>
<td><code><a href="../reference/detect_template.html">detect_template()</a></code></td>
<td>Find all template occurrences</td>
</tr>
<tr class="odd">
<td>5</td>
<td><code><a href="../reference/find_motif.html">find_motif()</a></code></td>
<td>Define motif boundaries around detections</td>
</tr>
<tr class="even">
<td>6</td>
<td><code><a href="../reference/visualize_segments.html">visualize_segments()</a></code></td>
<td>View extracted motif spectrograms</td>
</tr>
<tr class="odd">
<td>7</td>
<td><code><a href="../reference/plot_heatmap.html">plot_heatmap()</a></code></td>
<td>Visualize amplitude envelope patterns</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="key-parameters">Key Parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h3>
<table class="table">
<colgroup>
<col width="28%">
<col width="33%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Typical Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>start_time/end_time</code></td>
<td>Template time limits (seconds)</td>
<td>0.1-0.2s duration</td>
</tr>
<tr class="even">
<td><code>freq_min/freq_max</code></td>
<td>Frequency range (kHz)</td>
<td>1-10 kHz for zebra finch</td>
</tr>
<tr class="odd">
<td><code>pre_time</code></td>
<td>Time before template for motif start</td>
<td>0.5-0.8s</td>
</tr>
<tr class="even">
<td><code>lag_time</code></td>
<td>Time after template for motif end</td>
<td>0.3-0.6s</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="full-pipeline-with-sap-objects">Full Pipeline with SAP Objects<a class="anchor" aria-label="anchor" href="#full-pipeline-with-sap-objects"></a>
</h3>
<p>For analyzing multiple recordings across time points, ASAP provides a
streamlined pipeline using SAP objects:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create SAP object</span></span>
<span><span class="va">sap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_sap_object.html">create_sap_object</a></span><span class="op">(</span></span>
<span>  base_path <span class="op">=</span> <span class="st">"/path/to/recordings"</span>,</span>
<span>  subfolders_to_include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"190"</span>, <span class="st">"201"</span>, <span class="st">"203"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BL"</span>, <span class="st">"Post"</span>, <span class="st">"Rec"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run motif detection pipeline</span></span>
<span><span class="va">sap</span> <span class="op">&lt;-</span> <span class="va">sap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_audio_clip.html">create_audio_clip</a></span><span class="op">(</span>indices <span class="op">=</span> <span class="fl">1</span>, start_time <span class="op">=</span> <span class="fl">1</span>, end_time <span class="op">=</span> <span class="fl">2.5</span>, </span>
<span>                    clip_names <span class="op">=</span> <span class="st">"m1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_template.html">create_template</a></span><span class="op">(</span>template_name <span class="op">=</span> <span class="st">"d"</span>, clip_name <span class="op">=</span> <span class="st">"m1"</span>,</span>
<span>                  start_time <span class="op">=</span> <span class="fl">0.72</span>, end_time <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>                  freq_min <span class="op">=</span> <span class="fl">1</span>, freq_max <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                  threshold <span class="op">=</span> <span class="fl">0.5</span>, write_template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/detect_template.html">detect_template</a></span><span class="op">(</span>template_name <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_motif.html">find_motif</a></span><span class="op">(</span>template_name <span class="op">=</span> <span class="st">"d"</span>, pre_time <span class="op">=</span> <span class="fl">0.7</span>, lag_time <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/analyze_spectral.html">analyze_spectral</a></span><span class="op">(</span>balanced <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_clusters.html">find_clusters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_umap.html">run_umap</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize results</span></span>
<span><span class="va">sap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>balanced <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/plot_umap.html">plot_umap</a></span><span class="op">(</span>split.by <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ASAP_0.3.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10        generics_0.1.4     tidyr_1.3.2        lattice_0.22-7    </span></span>
<span><span class="co">#&gt;  [5] digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5     grid_4.5.2        </span></span>
<span><span class="co">#&gt;  [9] RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_2.0.0     Matrix_1.7-4      </span></span>
<span><span class="co">#&gt; [13] monitoR_1.2        tuneR_1.4.7        purrr_1.2.1        scales_1.4.0      </span></span>
<span><span class="co">#&gt; [17] pbapply_1.7-4      textshaping_1.0.4  jquerylib_0.1.4    cli_3.6.5         </span></span>
<span><span class="co">#&gt; [21] rlang_1.1.7        pbmcapply_1.5.1    withr_3.0.2        seewave_2.2.4     </span></span>
<span><span class="co">#&gt; [25] cachem_1.1.0       yaml_2.3.12        av_0.9.6           tools_4.5.2       </span></span>
<span><span class="co">#&gt; [29] parallel_4.5.2     dplyr_1.1.4        ggplot2_4.0.1      reticulate_1.44.1 </span></span>
<span><span class="co">#&gt; [33] vctrs_0.7.0        R6_2.6.1           png_0.1-8          lifecycle_1.0.5   </span></span>
<span><span class="co">#&gt; [37] fs_1.6.6           MASS_7.3-65        ragg_1.5.0         pkgconfig_2.0.3   </span></span>
<span><span class="co">#&gt; [41] desc_1.4.3         pkgdown_2.2.0      pillar_1.11.1      bslib_0.9.0       </span></span>
<span><span class="co">#&gt; [45] gtable_0.3.6       glue_1.8.0         Rcpp_1.1.1         systemfonts_1.3.1 </span></span>
<span><span class="co">#&gt; [49] xfun_0.56          tibble_3.3.1       tidyselect_1.2.1   knitr_1.51        </span></span>
<span><span class="co">#&gt; [53] farver_2.1.2       htmltools_0.5.9    patchwork_1.3.2    rmarkdown_2.30    </span></span>
<span><span class="co">#&gt; [57] signal_1.8-1       compiler_4.5.2     S7_0.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lei Xiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
