% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plot_clusters}
\alias{plot_clusters}
\alias{plot_clusters.matrix}
\alias{plot_clusters.Sap}
\title{Plot Clusters in Time Series Data}
\usage{
plot_clusters(x, ...)

\method{plot_clusters}{matrix}(x, labels = NULL, cluster_colors = NULL, main = NULL, ...)

\method{plot_clusters}{Sap}(
  x,
  data_type = c("segment", "syllable"),
  label_type = c("pre", "post"),
  time_resolution = 1000,
  cluster_colors = NULL,
  sample_percent = NULL,
  balanced = FALSE,
  labels = NULL,
  motif_clusters = NULL,
  ordered = FALSE,
  descending = TRUE,
  seed = 222,
  cores = NULL,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{x}{Object to plot clusters from. Can be either:
\itemize{
\item A matrix with cluster/syllable data
\item A Sap object containing bird song analysis data at motif and syllable levels
}}

\item{...}{Additional arguments passed between methods}

\item{labels}{Optional vector of experimental condition labels to subset (e.g., "BL", "Post", "Rec")}

\item{cluster_colors}{Optional named vector of colors for clusters}

\item{main}{Plot title (for matrix method)}

\item{data_type}{Type of data to analyze (for Sap objects):
\itemize{
\item "segment": Uses segment-level features and clusters
\item "syllable": Uses syllable-level features and clusters
}}

\item{label_type}{Type of labels to visualize (for Sap objects):
\itemize{
\item "pre": Shows numerical cluster IDs from automatic clustering
\item "post": Shows alphabetic syllable labels assigned via manual_label()
}}

\item{time_resolution}{Number of time points for plotting (default: 1000)}

\item{sample_percent}{Optional percentage of data to sample}

\item{balanced}{Whether to balance samples across labels}

\item{motif_clusters}{Optional vector of specific clusters to include}

\item{ordered}{Whether to order motifs by UMAP coordinates}

\item{descending}{Direction of UMAP-based ordering}

\item{seed}{Random seed for reproducibility}

\item{cores}{Number of cores for parallel processing}

\item{verbose}{Whether to print progress messages}
}
\value{
Invisibly returns x
}
\description{
Generic function for plotting clusters in time series data, primarily designed for
visualizing bird song syllable clusters and their manual labels. Supports both
numeric cluster IDs (pre manual labeling) and alphabetic syllable labels (post manual labeling).
}
\details{
The function provides two main visualization approaches:
\enumerate{
\item Pre-labeling visualization (label_type = "pre"):
\itemize{
\item Shows numerical cluster IDs from automatic clustering
\item Uses data from x$features$segment/syllable$feat.embeds
\item Clusters are represented by numbers (1, 2, 3, etc.)
\item Useful for evaluating automatic clustering results
}
\item Post-labeling visualization (label_type = "post"):
\itemize{
\item Shows alphabetic syllable labels from manual annotation
\item Uses data from x$syllables (created by manual_label())
\item Syllables are represented by letters (a, b, c, etc.)
\item Useful for viewing manual syllable classifications
}
}

For matrix input:
\itemize{
\item Must have column names as labels
\item Requires a 'time_window' attribute
\item Can contain either numeric clusters or character syllable labels
}

For Sap objects:
\itemize{
\item data_type determines the feature level for analysis:
\itemize{
\item "segment": Fine-grained analysis of song segments
\item "syllable": Analysis at the syllable level
}
\item Supports experimental condition labels (BL, Post, Rec)
\item Can order motifs by UMAP coordinates for pattern visualization
\item Allows balanced sampling across conditions
}
}
\examples{
\dontrun{
# Matrix method example
mat <- matrix(sample(1:5, 1000, replace = TRUE), ncol = 10)
attr(mat, "time_window") <- 1.2
colnames(mat) <- rep(c("BL", "Post"), each = 5)
plot_clusters(mat)

# Sap object - Pre-labeling (numerical clusters)
# Basic cluster visualization
plot_clusters(sap,
            data_type = "syllable",
            label_type = "pre")

# Ordered by UMAP with specific conditions
plot_clusters(sap,
            data_type = "syllable",
            label_type = "pre",
            ordered = TRUE,
            labels = c("BL", "Post"))

# Sap object - Post-labeling (syllable letters)
# After running manual_label()
plot_clusters(sap,
            data_type = "syllable",
            label_type = "post")

# Balanced sampling across conditions
plot_clusters(sap,
            data_type = "syllable",
            label_type = "post",
            balanced = TRUE,
            labels = c("BL", "Post", "Rec"))
}

}
\seealso{
\itemize{
\item manual_label() for creating syllable labels
\item auto_label() for automatic cluster generation
}
}
