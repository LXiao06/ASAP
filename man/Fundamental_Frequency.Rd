% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pitch.R
\name{FF}
\alias{FF}
\alias{FF.default}
\alias{FF.data.frame}
\alias{FF.Sap}
\alias{FF.matrix}
\title{Fundamental Frequency Analysis and Visualization}
\usage{
FF(x, ...)

\method{FF}{default}(
  x,
  start_time = NULL,
  end_time = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1400,
  threshold = 10,
  method = c("cepstrum", "yin"),
  plot = TRUE,
  ...
)

\method{FF}{data.frame}(
  x,
  wav_dir = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1400,
  threshold = 10,
  method = c("cepstrum", "yin"),
  plot = TRUE,
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  cores = NULL,
  ...
)

\method{FF}{Sap}(
  x,
  segment_type = c("motifs", "syllables", "segments"),
  sample_percent = NULL,
  balanced = FALSE,
  labels = NULL,
  clusters = NULL,
  cores = NULL,
  seed = 222,
  wl = 512,
  ovlp = 50,
  fmax = 1400,
  threshold = 10,
  method = c("cepstrum", "yin"),
  plot = TRUE,
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  ordered = FALSE,
  descending = TRUE,
  verbose = TRUE,
  ...
)

\method{FF}{matrix}(
  x,
  labels = NULL,
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  main = "Fundamental Frequency Heatmap",
  ...
)
}
\arguments{
\item{x}{Input object:
\itemize{
\item character: path to WAV file (default method)
\item data frame: containing segment information
\item SAP object
\item Pre-computed F0 matrix
}}

\item{...}{Additional arguments passed to methods or lattice::levelplot}

\item{start_time}{Numeric, start time in seconds (for default method)}

\item{end_time}{Numeric, end time in seconds (for default method)}

\item{wl}{Window length for spectral analysis (default: 512)}

\item{ovlp}{Overlap percentage between windows (default: 50)}

\item{fmax}{Maximum frequency to consider (default: 1400 Hz)}

\item{threshold}{Amplitude threshold for pitch detection in \% (default: 10)}

\item{method}{Pitch estimation method ("cepstrum" or "yin")}

\item{plot}{Logical, whether to generate visualization(default: TRUE)}

\item{wav_dir}{Directory containing WAV files (for data frame methods)}

\item{plot_freq_lim}{Optional vector of length 2 specifying frequency limits for plotting}

\item{color_palette}{Function generating color palette (default: black-to-red spectrum)}

\item{n_colors}{Number of colors in heatmap (default: 500)}

\item{cores}{Number of cores for parallel processing}

\item{segment_type}{For SAP objects: Type of segments (currently only 'motifs')}

\item{sample_percent}{For SAP objects: Percentage of segments to sample}

\item{balanced}{For SAP objects: Whether to balance samples across labels}

\item{labels}{Optional vector of labels for subsetting or grouping}

\item{clusters}{For SAP objects: Numeric vector of cluster IDs to include}

\item{seed}{Random seed for sampling (default: 222)}

\item{ordered}{For SAP objects: Whether to order by feature embeddings}

\item{descending}{For SAP objects: Direction of embedding-based ordering}

\item{verbose}{Logical, whether to print progress messages}

\item{main}{Plot title (for matrix method)}
}
\value{
Returns an object depending on the method used:
\itemize{
\item Default method: Matrix of time and frequency values
\item Data frame method: List with F0 matrix and metadata
\item SAP method: Updated SAP object with F0 features
\item Matrix method: Lattice plot object (invisibly)
}
}
\description{
Creates fundamental frequency analyses and visualizations from audio segments, supporting
multiple data types (WAV file, data frames, SAP objects) and visualization options.
Provides both analytical results and optional single trial or heatmap visualizations.
}
\details{
The function provides different methods depending on the input type:

Default method (WAV file method):
\itemize{
\item Analyzes a single WAV file within specified time window
\item Supports both cepstrum and YIN-based pitch detection
\item Creates spectrogram with F0 overlay visualization
}

Data frame method:
\itemize{
\item Processes multiple segments in parallel
\item Normalizes time series across renditions
\item Creates aligned F0 matrix
\item Generates heatmap visualization for multiple segments
}

SAP object method:
\itemize{
\item Integrates with SAP feature analysis pipeline
\item Supports segment filtering and ordering
\item Stores results in features component
}

Matrix method:
\itemize{
\item Visualizes pre-computed F0 data
\item Supports label-based organization
\item Adds visual separators between groups
}
}
\examples{
\dontrun{
# Single WAV file analysis
FF("path/to/sound.wav", start_time = 1, end_time = 2)

# Multiple segment analysis
FF(segments_df, wav_dir = "path/to/wavs",
   plot = TRUE, plot_freq_lim = c(0.5, 1.5))

# SAP object analysis
FF(sap_obj, ordered = TRUE, balanced = TRUE,
   sample_percent = 80, seed = 123)

# Direct matrix visualization
FF(f0_matrix, labels = c("a", "b", "c"),
   main = "Custom Title")
}

}
\seealso{
\code{\link[lattice]{levelplot}} for underlying plotting function
\code{\link[seewave]{fund}} for cepstral analysis
\code{\link[librosa]{yin}} for YIN algorithm (when using method = "yin")
}
