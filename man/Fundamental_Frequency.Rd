% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pitch.R
\name{FF}
\alias{FF}
\alias{FF.default}
\alias{FF.Sap}
\alias{FF.matrix}
\title{Fundamental Frequency Analysis and Visualization}
\usage{
FF(x, ...)

\method{FF}{default}(
  x,
  wav_dir = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1400,
  threshold = 10,
  method = c("cepstrum", "yin"),
  plot = TRUE,
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  cores = NULL,
  verbose = TRUE,
  ...
)

\method{FF}{Sap}(
  x,
  segment_type = c("motifs", "syllables", "segments"),
  sample_percent = NULL,
  balanced = FALSE,
  labels = NULL,
  clusters = NULL,
  cores = NULL,
  seed = 222,
  wl = 512,
  ovlp = 50,
  fmax = 1400,
  threshold = 10,
  method = c("cepstrum", "yin"),
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  ordered = FALSE,
  descending = TRUE,
  verbose = TRUE,
  ...
)

\method{FF}{matrix}(
  x,
  labels = NULL,
  plot_freq_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  main = "Fundamental Frequency Heatmap",
  ...
)
}
\arguments{
\item{x}{Input object:
\itemize{
\item data frame (default method)
\item SAP object
\item Pre-computed F0 matrix
}}

\item{...}{Additional arguments passed to methods or lattice::levelplot}

\item{wav_dir}{Directory containing WAV files (for data frame methods)}

\item{wl}{Window length for spectral analysis (default: 512)}

\item{ovlp}{Overlap percentage between windows (default: 50)}

\item{fmax}{Maximum frequency to consider (default: 1400 Hz)}

\item{threshold}{Amplitude threshold for pitch detection in \% (default: 10)}

\item{method}{Pitch estimation method ("cepstrum" or "yin")}

\item{plot}{Logical, whether to generate visualization(default: TRUE)}

\item{plot_freq_lim}{Optional vector of length 2 specifying frequency limits for plotting}

\item{color_palette}{Function generating color palette (default: black-to-red spectrum)}

\item{n_colors}{Number of colors in heatmap (default: 500)}

\item{cores}{Number of cores for parallel processing}

\item{verbose}{Logical, whether to print progress messages}

\item{segment_type}{For SAP objects: Type of segments (currently only 'motifs')}

\item{sample_percent}{For SAP objects: Percentage of segments to sample}

\item{balanced}{For SAP objects: Whether to balance samples across labels}

\item{labels}{Optional vector of labels for subsetting or grouping}

\item{clusters}{For SAP objects: Numeric vector of cluster IDs to include}

\item{seed}{Random seed for sampling (default: 222)}

\item{ordered}{For SAP objects: Whether to order by feature embeddings}

\item{descending}{For SAP objects: Direction of embedding-based ordering}

\item{main}{Plot title (for matrix method)}
}
\value{
Returns an object depending on the method used:
\itemize{
\item Default method: Matrix of time and frequency values(F0 matrix)
or List with F0 matrix and metadata
\item SAP method: Updated SAP object with F0 features
\item Matrix method: Lattice plot object (invisibly)
}
}
\description{
Creates fundamental frequency analyses and visualizations from audio segments, supporting
multiple data types (data frames, SAP objects) and visualization options.
Provides both analytical results and optional single trial or heatmap visualizations.
}
\details{
The function provides different methods depending on the input type:

Default method (Data frame method)
\itemize{
\item Performs fundamental frequency analysis on a single segment
or processes multiple segments in parallel
\item Supports both cepstrum and YIN-based pitch detection
\item Normalizes time series across renditions
\item Creates aligned F0 matrix
\item Optional spectrogram overlay (single segment)
or heatmap visualization(multiple segments)
}

SAP object method:
\itemize{
\item Integrates with SAP feature analysis pipeline
\item Supports segment filtering and ordering
\item Stores results in features component
}

Matrix method:
\itemize{
\item Visualizes pre-computed F0 data
\item Supports label-based organization
\item Adds visual separators between groups
}
}
\examples{
\dontrun{
# Single segment analysis
FF(segment_row, wav_dir = "path/to/wavs", plot = TRUE)

# Multiple segment analysis
FF(segments_df, wav_dir = "path/to/wavs",
   plot = TRUE, plot_freq_lim = c(0.5, 1.5))

# SAP object analysis
FF(sap_obj, ordered = TRUE, balanced = TRUE,
   sample_percent = 80, seed = 123)

# Direct matrix visualization
FF(f0_matrix, labels = c("a", "b", "c"),
   main = "Custom Title")
}

}
\seealso{
\code{\link[lattice]{levelplot}} for underlying plotting function
\code{\link[seewave]{fund}} for cepstral analysis
\code{\link[librosa]{yin}} for YIN algorithm (when using method = "yin")
}
