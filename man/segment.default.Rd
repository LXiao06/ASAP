% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/segment.R
\name{segment.default}
\alias{segment.default}
\title{Segment Individual Audio File into Syllables}
\usage{
\method{segment}{default}(
  x,
  start_time = NULL,
  end_time = NULL,
  wl = 256,
  ovlp = 80,
  flim = c(1, 10),
  silence_threshold = 0.05,
  min_syllable_ms = 50,
  max_syllable_ms = 200,
  min_level_db = 0,
  max_level_db = 40,
  db_delta = 5,
  search_direction = c("up", "down"),
  verbose = TRUE,
  plot = TRUE,
  smooth = FALSE,
  save_plot = FALSE,
  plot_dir = NULL,
  ...
)
}
\arguments{
\item{x}{Character. Full path to the audio file.}

\item{start_time}{Numeric. Optional. Start time in seconds.
If not provided: start_time defaults to 0 with warning}

\item{end_time}{Numeric. Optional. End time in seconds.
If not provided: end_time defaults to file duration}

\item{wl}{Numeric. Window length for spectrogram calculation.
Default is 256.}

\item{ovlp}{Numeric. Overlap percentage between windows (0-100).
Default is 80.}

\item{flim}{Numeric vector of length 2. Frequency limits in kHz.
Default is c(1, 10).}

\item{silence_threshold}{Numeric. Threshold for silence detection (0-1). Default is 0.05.}

\item{min_syllable_ms}{Numeric. Minimum syllable length in milliseconds.
Default is 50.}

\item{max_syllable_ms}{Numeric. Maximum syllable length in milliseconds.
Default is 200.}

\item{min_level_db}{Numeric. Minimum threshold level in dB. Default is 0.
Represents the quietest sounds to detect. When combined with internal reference
level (20 dB), corresponds to -60 dB relative to full scale.}

\item{max_level_db}{Numeric. Maximum threshold level in dB. Default is 40.
Represents the loudest sounds to detect. When combined with internal reference
level (20 dB), corresponds to -20 dB relative to full scale.}

\item{db_delta}{Numeric. Step size for threshold search in dB. Default is 5.}

\item{search_direction}{Character. Direction for threshold search: "up" or "down".
\itemize{
\item "up": Starts from min_level_db and increases (recommended for quiet or variable recordings)
\item "down": Starts from max_level_db and decreases (recommended for loud, clear recordings)
}}

\item{verbose}{Logical. If TRUE, prints progress information. Default is TRUE.}

\item{plot}{Logical. If TRUE, displays detection plot. Default is TRUE.}

\item{smooth}{Logical. If TRUE, smooths spectrogram visualization. Default is FALSE.}

\item{save_plot}{Logical. If TRUE, detection plot is saved to a local directory. Default FALSE.}

\item{plot_dir}{Character. Directory to save plots. Default NULL.}
}
\value{
Returns a data frame containing syllable information:
\itemize{
\item filename: Name of the audio file
\item selec: Sequential number for each syllable
\item threshold: Final threshold used for detection
\item .start: Start time relative to the analyzed segment
\item .end: End time relative to the analyzed segment
\item start_time: Absolute start time in the original audio file
\item end_time: Absolute end time in the original audio file
\item duration: Duration of syllable in seconds
\item silence_gap: Gap to next syllable in seconds (NA for last syllable)
}

If no syllables are detected, returns NULL.
}
\description{
Segments a single audio recording into syllables using dynamic
thresholding of the spectrogram.
}
\details{
The function implements a robust syllable detection algorithm using the following steps:
\enumerate{
\item Reads and validates the audio file
\item Computes the spectrogram using Short-Time Fourier Transform
\item Performs adaptive thresholding to detect syllables
\item Validates detected segments against duration constraints
\item Optionally generates visualization plots
}

The function uses an internal reference level of 20 dB to convert between user-friendly
positive dB values and actual dB measurements relative to full scale (dBFS).

dB Scale Conversion:
\itemize{
\item User input: 0 to 40 dB (intuitive positive scale)
\item Internal conversion: Subtracts reference level (20 dB)
\item Actual dBFS: -60 to -20 dB relative to full scale
}

Search Direction Guidelines:
\itemize{
\item Use "up" when:
\itemize{
\item Recording has variable amplitude
\item Background noise is significant
\item Want to detect quieter syllables
}
\item Use "down" when:
\itemize{
\item Recording is clean with good SNR
\item Want to avoid false positives
\item Syllables are consistently loud
}
}
}
\examples{
\dontrun{
# Basic usage with default parameters
syllables <- segment("path/to/audio.wav")

# For clean recordings with consistent loud syllables
syllables <- segment(
  file_path = "path/to/clean_audio.wav",
  start_time = 0,
  end_time = 1,
  search_direction = "down"
)

# For recordings with variable amplitude or background noise
syllables <- segment(
  file_path = "path/to/noisy_audio.wav",
  start_time = 0,
  end_time = 1,
  search_direction = "up"
)
}

}
