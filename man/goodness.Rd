% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pitch.R
\name{goodness}
\alias{goodness}
\alias{goodness.default}
\alias{goodness.Sap}
\alias{goodness.matrix}
\title{Pitch Goodness Analysis}
\usage{
goodness(x, ...)

\method{goodness}{default}(
  x,
  wav_dir = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1500,
  plot = TRUE,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  cores = NULL,
  ...
)

\method{goodness}{Sap}(
  x,
  segment_type = c("motifs", "syllables", "segments"),
  sample_percent = NULL,
  balanced = FALSE,
  labels = NULL,
  clusters = NULL,
  cores = NULL,
  seed = 222,
  wl = 512,
  ovlp = 50,
  fmax = 1500,
  plot = TRUE,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  ordered = FALSE,
  descending = TRUE,
  verbose = TRUE,
  ...
)

\method{goodness}{matrix}(
  x,
  labels = NULL,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  main = "Pitch Goodness Heatmap",
  ...
)
}
\arguments{
\item{x}{Input object:
\itemize{
\item  Data frame (default method)
\item SAP object
\item Pre-computed goodness matrix
}}

\item{...}{Additional arguments passed to methods or plotting functions}

\item{wav_dir}{Directory containing WAV files (for data frame methods)}

\item{wl}{Window length for spectral analysis (default: 512)}

\item{ovlp}{Overlap percentage between windows (default: 50)}

\item{fmax}{Maximum frequency to consider (default: 1500 Hz)}

\item{plot}{Logical, whether to generate visualization (default: TRUE)}

\item{plot_lim}{Optional vector of length 2 specifying goodness limits for plotting}

\item{color_palette}{Function generating color palette (default: black-to-white spectrum)}

\item{n_colors}{Number of colors in heatmap (default: 500)}

\item{cores}{Number of cores for parallel processing}

\item{segment_type}{For SAP objects: Type of segments (currently only 'motifs')}

\item{sample_percent}{For SAP objects: Percentage of segments to sample}

\item{balanced}{For SAP objects: Whether to balance samples across labels}

\item{labels}{Optional vector of labels for subsetting or grouping}

\item{clusters}{For SAP objects: Numeric vector of cluster IDs to include}

\item{seed}{Random seed for sampling (default: 222)}

\item{ordered}{For SAP objects: Whether to order by feature embeddings}

\item{descending}{For SAP objects: Direction of embedding-based ordering}

\item{verbose}{Logical, whether to print progress messages(default: TRUE)}

\item{main}{Plot title (for matrix method)}
}
\value{
For single segments (nrow = 1):
\itemize{
\item Matrix with columns: time, goodness
}

For multiple segments (nrow > 1):
\itemize{
\item List with components:
\describe{
\item{goodness_matrix}{Matrix of aligned goodness values}
\item{reference_time}{Vector of reference time points}
\item{original_times}{List of original time vectors}
\item{plot}{If plot=TRUE, the generated lattice plot}
}
}
}
\description{
Calculates and visualizes pitch goodness for audio segments using cepstral analysis.
Supports both single segment analysis and batch processing with visualization options.
}
\details{
The function provides different methods depending on the input type:

Default method (data frame):
\itemize{
\item Processes single or multiple segments
\item Uses cepstral analysis for pitch goodness calculation
\item Supports parallel processing for multiple segments
\item Provides optional visualization
}

The pitch goodness measure:
\itemize{
\item Based on cepstral peak prominence
\item Higher values indicate stronger pitch periodicity
\item Computed across time windows
\item Normalized for comparison across segments
}
}
\examples{
\dontrun{
# Single segment analysis
goodness(segment_row, wav_dir = "path/to/wavs", plot = TRUE)

# Multiple segment analysis
goodness(segments_df, wav_dir = "path/to/wavs",
         plot = TRUE, plot_lim = c(0, 1))

# SAP object analysis
goodness(sap_obj, ordered = TRUE, balanced = TRUE,
   sample_percent = 80, seed = 123)

# Direct matrix visualization
goodness(goodness_matrix, labels = c("a", "b", "c"),
   main = "Custom Title")
}

}
\seealso{
\code{\link{FF}} for fundamental frequency analysis
\code{\link[seewave]{spectro}} for underlying spectral analysis
}
