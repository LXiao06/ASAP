% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pitch.R
\name{goodness}
\alias{goodness}
\alias{goodness.default}
\alias{goodness.data.frame}
\alias{goodness.Sap}
\alias{goodness.matrix}
\title{Pitch Goodness Analysis}
\usage{
goodness(x, ...)

\method{goodness}{default}(
  x,
  start_time = NULL,
  end_time = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1500,
  plot = TRUE,
  ...
)

\method{goodness}{data.frame}(
  x,
  wav_dir = NULL,
  wl = 512,
  ovlp = 50,
  fmax = 1500,
  plot = TRUE,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  cores = NULL,
  ...
)

\method{goodness}{Sap}(
  x,
  segment_type = c("motifs", "syllables", "segments"),
  sample_percent = NULL,
  balanced = FALSE,
  labels = NULL,
  clusters = NULL,
  cores = NULL,
  seed = 222,
  wl = 512,
  ovlp = 50,
  fmax = 1500,
  plot = TRUE,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  ordered = FALSE,
  descending = TRUE,
  verbose = TRUE,
  ...
)

\method{goodness}{matrix}(
  x,
  labels = NULL,
  plot_lim = NULL,
  color_palette = NULL,
  n_colors = 500,
  main = "Pitch Goodness Heatmap",
  ...
)
}
\arguments{
\item{x}{Input object:
\itemize{
\item character: path to WAV file (default method)
\item data frame: containing segment information
\item SAP object
\item Pre-computed goodness matrix
}}

\item{...}{Additional arguments passed to methods or plotting functions}

\item{start_time}{Numeric, start time in seconds (for default method)}

\item{end_time}{Numeric, end time in seconds (for default method)}

\item{wl}{Window length for spectral analysis (default: 512)}

\item{ovlp}{Overlap percentage between windows (default: 50)}

\item{fmax}{Maximum frequency to consider (default: 1500 Hz)}

\item{plot}{Logical, whether to generate visualization (default: TRUE)}

\item{wav_dir}{Directory containing WAV files (for data frame methods)}

\item{plot_lim}{Optional vector of length 2 specifying goodness limits for plotting}

\item{color_palette}{Function generating color palette (default: black-to-white spectrum)}

\item{n_colors}{Number of colors in heatmap (default: 500)}

\item{cores}{Number of cores for parallel processing}

\item{segment_type}{For SAP objects: Type of segments (currently only 'motifs')}

\item{sample_percent}{For SAP objects: Percentage of segments to sample}

\item{balanced}{For SAP objects: Whether to balance samples across labels}

\item{labels}{Optional vector of labels for subsetting or grouping}

\item{clusters}{For SAP objects: Numeric vector of cluster IDs to include}

\item{seed}{Random seed for sampling (default: 222)}

\item{ordered}{For SAP objects: Whether to order by feature embeddings}

\item{descending}{For SAP objects: Direction of embedding-based ordering}

\item{verbose}{Logical, whether to print progress messages(default: TRUE)}

\item{main}{Plot title (for matrix method)}
}
\value{
Depending on the method used:
\itemize{
\item Default method (WAV file):
\describe{
\item{Matrix}{With columns: time, goodness}
}
\item Data frame method:
\describe{
\item{List}{With components: goodness_matrix, reference_time, original_times, plot (if plot=TRUE)}
}
\item SAP method:
\describe{
\item{SAP object}{Updated with goodness features}
}
\item Matrix method:
\describe{
\item{Lattice plot}{(invisibly)}
}
}
}
\description{
Calculates and visualizes pitch goodness for audio segments using cepstral analysis.
Supports single WAV file analysis, batch processing, and multiple visualization options.
}
\details{
The function provides different methods depending on the input type:

Default method (WAV file):
\itemize{
\item Analyzes a single WAV file within specified time window
\item Uses cepstral analysis for pitch goodness calculation
\item Creates spectrogram with goodness overlay visualization
}

Data frame method:
\itemize{
\item Processes multiple segments in parallel
\item Supports batch processing
\item Provides heatmap visualization for multiple segments
}
SAP object method:
\itemize{
\item Integrates with SAP feature analysis pipeline
\item Supports segment filtering and ordering
\item Stores results in features component
}

Matrix method:
\itemize{
\item Visualizes pre-computed F0 data
\item Supports label-based organization
\item Adds visual separators between groups
}

SAP object method:
\itemize{
\item Integrates with SAP feature analysis pipeline
\item Supports segment filtering and ordering
\item Stores results in features component
}

Matrix method:
\itemize{
\item Visualizes pre-computed pitch goodness data
\item Supports label-based organization
\item Adds visual separators between groups
}

The pitch goodness measure:
\itemize{
\item Based on cepstral peak prominence
\item Higher values indicate stronger pitch periodicity
\item Computed across time windows
\item Normalized for comparison across segments
}
}
\examples{
\dontrun{
# Single WAV file analysis
goodness("path/to/sound.wav", start_time = 1, end_time = 2)

# Multiple segment analysis
goodness(segments_df, wav_dir = "path/to/wavs",
         plot = TRUE, plot_lim = c(0, 1))

# SAP object analysis
goodness(sap_obj, ordered = TRUE, balanced = TRUE,
   sample_percent = 80, seed = 123)

# Direct matrix visualization
goodness(goodness_matrix, labels = c("a", "b", "c"),
   main = "Custom Title")
}

}
\seealso{
\code{\link{FF}} for fundamental frequency analysis
\code{\link[seewave]{spectro}} for underlying spectral analysis
}
