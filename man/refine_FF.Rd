% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pitch.R
\name{refine_FF}
\alias{refine_FF}
\title{Refine Fundamental Frequency Detection}
\usage{
refine_FF(
  x,
  segment_type = c("motifs", "syllables", "segments"),
  reference_label,
  method = c("quantile", "hmm"),
  minimal_duration = 20,
  split_dips = TRUE,
  quantile_threshold = 0.5,
  random_seed = 222,
  plot = TRUE,
  plot_freq_lim = NULL,
  color_palette = NULL,
  stats = TRUE,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{x}{A Sap object containing fundamental frequency and pitch goodness data}

\item{segment_type}{Character, type of segment to analyze: "motifs", "syllables", or "segments"}

\item{reference_label}{Character, label to use as reference for template creation}

\item{method}{Character, method for template creation: "quantile" or "hmm"}

\item{minimal_duration}{Numeric, minimum duration (in ms) for valid segments}

\item{split_dips}{Logical, whether to split segments at significant dips in goodness}

\item{quantile_threshold}{Numeric, threshold for quantile method (0-1)}

\item{random_seed}{Numeric, seed for reproducibility}

\item{plot}{Logical, whether to plot the results}

\item{plot_freq_lim}{Numeric vector of length 2, frequency limits for plotting}

\item{color_palette}{Function, color palette for plotting}

\item{stats}{Logical, whether to calculate segment statistics}

\item{verbose}{Logical, whether to print access information}

\item{...}{Additional arguments passed to plotting functions}
}
\value{
Invisibly returns the modified Sap object with refined fundamental frequency data
}
\description{
Refines fundamental frequency detection by identifying regions of reliable pitch tracking
using various methods and applying temporal constraints.
}
\details{
The function uses either quantile-based thresholding or Hidden Markov Models to identify
regions of reliable pitch tracking. It can optionally split segments at local minima in
pitch goodness and applies minimum duration constraints.

When using the 'hmm' method, the package 'depmixS4' is required.
If not installed, the function will prompt for installation.
}
\note{
The HMM method requires the 'depmixS4' package to be installed.
}
\examples{
\dontrun{
# Default method
sap <- refine_FF(sap,
                  reference_label = "BL",
                  method = "quantile",
                  plot = TRUE)
# hmm method
sap <- refine_FF(sap,
                  reference_label = "BL",
                  method = "hmm")

}


}
