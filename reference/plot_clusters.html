<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Clusters in Time Series Data — plot_clusters • ASAP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Clusters in Time Series Data — plot_clusters"><meta name="description" content="Generic function for plotting clusters in time series data, primarily designed for
visualizing bird song syllable clusters and their manual labels. Supports both
numeric cluster IDs (pre manual labeling) and alphabetic syllable labels (post manual labeling)."><meta property="og:description" content="Generic function for plotting clusters in time series data, primarily designed for
visualizing bird song syllable clusters and their manual labels. Supports both
numeric cluster IDs (pre manual labeling) and alphabetic syllable labels (post manual labeling)."><meta property="og:image" content="https://lxiao06.github.io/ASAP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASAP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot Clusters in Time Series Data</h1>

      <div class="d-none name"><code>plot_clusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function for plotting clusters in time series data, primarily designed for
visualizing bird song syllable clusters and their manual labels. Supports both
numeric cluster IDs (pre manual labeling) and alphabetic syllable labels (post manual labeling).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">x</span>, labels <span class="op">=</span> <span class="cn">NULL</span>, cluster_colors <span class="op">=</span> <span class="cn">NULL</span>, main <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Sap'</span></span>
<span><span class="fu">plot_clusters</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  data_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"segment"</span>, <span class="st">"syllable"</span><span class="op">)</span>,</span>
<span>  label_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span>,</span>
<span>  time_resolution <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cluster_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_percent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  balanced <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  motif_clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  descending <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">222</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Object to plot clusters from. Can be either:</p><ul><li><p>A matrix with cluster/syllable data</p></li>
<li><p>A Sap object containing bird song analysis data at motif and syllable levels</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed between methods</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>Optional vector of experimental condition labels to subset (e.g., "BL", "Post", "Rec")</p></dd>


<dt id="arg-cluster-colors">cluster_colors<a class="anchor" aria-label="anchor" href="#arg-cluster-colors"></a></dt>
<dd><p>Optional named vector of colors for clusters</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Plot title (for matrix method)</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>Type of data to analyze (for Sap objects):</p><ul><li><p>"segment": Uses segment-level features and clusters</p></li>
<li><p>"syllable": Uses syllable-level features and clusters</p></li>
</ul></dd>


<dt id="arg-label-type">label_type<a class="anchor" aria-label="anchor" href="#arg-label-type"></a></dt>
<dd><p>Type of labels to visualize (for Sap objects):</p><ul><li><p>"pre": Shows numerical cluster IDs from automatic clustering</p></li>
<li><p>"post": Shows alphabetic syllable labels assigned via manual_label()</p></li>
</ul></dd>


<dt id="arg-time-resolution">time_resolution<a class="anchor" aria-label="anchor" href="#arg-time-resolution"></a></dt>
<dd><p>Number of time points for plotting (default: 1000)</p></dd>


<dt id="arg-sample-percent">sample_percent<a class="anchor" aria-label="anchor" href="#arg-sample-percent"></a></dt>
<dd><p>Optional percentage of data to sample</p></dd>


<dt id="arg-balanced">balanced<a class="anchor" aria-label="anchor" href="#arg-balanced"></a></dt>
<dd><p>Whether to balance samples across labels</p></dd>


<dt id="arg-motif-clusters">motif_clusters<a class="anchor" aria-label="anchor" href="#arg-motif-clusters"></a></dt>
<dd><p>Optional vector of specific clusters to include</p></dd>


<dt id="arg-ordered">ordered<a class="anchor" aria-label="anchor" href="#arg-ordered"></a></dt>
<dd><p>Whether to order motifs by UMAP coordinates</p></dd>


<dt id="arg-descending">descending<a class="anchor" aria-label="anchor" href="#arg-descending"></a></dt>
<dd><p>Direction of UMAP-based ordering</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducibility</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Number of cores for parallel processing</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether to print progress messages</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns x</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function provides two main visualization approaches:</p><ol><li><p>Pre-labeling visualization (label_type = "pre"):</p><ul><li><p>Shows numerical cluster IDs from automatic clustering</p></li>
<li><p>Uses data from x$features$segment/syllable$feat.embeds</p></li>
<li><p>Clusters are represented by numbers (1, 2, 3, etc.)</p></li>
<li><p>Useful for evaluating automatic clustering results</p></li>
</ul></li>
<li><p>Post-labeling visualization (label_type = "post"):</p><ul><li><p>Shows alphabetic syllable labels from manual annotation</p></li>
<li><p>Uses data from x$syllables (created by manual_label())</p></li>
<li><p>Syllables are represented by letters (a, b, c, etc.)</p></li>
<li><p>Useful for viewing manual syllable classifications</p></li>
</ul></li>
</ol><p>For matrix input:</p><ul><li><p>Must have column names as labels</p></li>
<li><p>Requires a 'time_window' attribute</p></li>
<li><p>Can contain either numeric clusters or character syllable labels</p></li>
</ul><p>For Sap objects:</p><ul><li><p>data_type determines the feature level for analysis:</p><ul><li><p>"segment": Fine-grained analysis of song segments</p></li>
<li><p>"syllable": Analysis at the syllable level</p></li>
</ul></li>
<li><p>Supports experimental condition labels (BL, Post, Rec)</p></li>
<li><p>Can order motifs by UMAP coordinates for pattern visualization</p></li>
<li><p>Allows balanced sampling across conditions</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>manual_label() for creating syllable labels</p></li>
<li><p>auto_label() for automatic cluster generation</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Matrix method example</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">mat</span>, <span class="st">"time_window"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BL"</span>, <span class="st">"Post"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sap object - Pre-labeling (numerical clusters)</span></span></span>
<span class="r-in"><span><span class="co"># Basic cluster visualization</span></span></span>
<span class="r-in"><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">sap</span>,</span></span>
<span class="r-in"><span>            data_type <span class="op">=</span> <span class="st">"syllable"</span>,</span></span>
<span class="r-in"><span>            label_type <span class="op">=</span> <span class="st">"pre"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ordered by UMAP with specific conditions</span></span></span>
<span class="r-in"><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">sap</span>,</span></span>
<span class="r-in"><span>            data_type <span class="op">=</span> <span class="st">"syllable"</span>,</span></span>
<span class="r-in"><span>            label_type <span class="op">=</span> <span class="st">"pre"</span>,</span></span>
<span class="r-in"><span>            ordered <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BL"</span>, <span class="st">"Post"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sap object - Post-labeling (syllable letters)</span></span></span>
<span class="r-in"><span><span class="co"># After running manual_label()</span></span></span>
<span class="r-in"><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">sap</span>,</span></span>
<span class="r-in"><span>            data_type <span class="op">=</span> <span class="st">"syllable"</span>,</span></span>
<span class="r-in"><span>            label_type <span class="op">=</span> <span class="st">"post"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Balanced sampling across conditions</span></span></span>
<span class="r-in"><span><span class="fu">plot_clusters</span><span class="op">(</span><span class="va">sap</span>,</span></span>
<span class="r-in"><span>            data_type <span class="op">=</span> <span class="st">"syllable"</span>,</span></span>
<span class="r-in"><span>            label_type <span class="op">=</span> <span class="st">"post"</span>,</span></span>
<span class="r-in"><span>            balanced <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BL"</span>, <span class="st">"Post"</span>, <span class="st">"Rec"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lei Xiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

