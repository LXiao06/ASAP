<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find Clusters in Feature Data — find_clusters • ASAP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Find Clusters in Feature Data — find_clusters"><meta name="description" content="Performs cluster analysis on feature data using shared nearest neighbor (SNN) clustering.
Internal functions adapted from the Seurat package for neighbor finding
and cluster analysis. These functions are modified versions of the
original Seurat code."><meta property="og:description" content="Performs cluster analysis on feature data using shared nearest neighbor (SNN) clustering.
Internal functions adapted from the Seurat package for neighbor finding
and cluster analysis. These functions are modified versions of the
original Seurat code."><meta property="og:image" content="https://lxiao06.github.io/ASAP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ASAP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Find Clusters in Feature Data</h1>

      <div class="d-none name"><code>find_clusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs cluster analysis on feature data using shared nearest neighbor (SNN) clustering.</p>
<p>Internal functions adapted from the Seurat package for neighbor finding
and cluster analysis. These functions are modified versions of the
original Seurat code.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_clusters</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">find_clusters</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">metadata_cols</span>,</span>
<span>  k.param <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  prune.SNN <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span>,</span>
<span>  n.pcs <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  n.start <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Sap'</span></span>
<span><span class="fu">find_clusters</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  segment_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"motifs"</span>, <span class="st">"syllables"</span>, <span class="st">"segments"</span><span class="op">)</span>,</span>
<span>  data_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spectral_feature"</span>, <span class="st">"spectrogram"</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k.param <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  prune.SNN <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span>,</span>
<span>  n.pcs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resolution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.start <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object to analyze, either a data frame or SAP object</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to specific methods</p></dd>


<dt id="arg-metadata-cols">metadata_cols<a class="anchor" aria-label="anchor" href="#arg-metadata-cols"></a></dt>
<dd><p>For default method: Column indices for metadata</p></dd>


<dt id="arg-k-param">k.param<a class="anchor" aria-label="anchor" href="#arg-k-param"></a></dt>
<dd><p>Number of nearest neighbors (default: 20)</p></dd>


<dt id="arg-prune-snn">prune.SNN<a class="anchor" aria-label="anchor" href="#arg-prune-snn"></a></dt>
<dd><p>Pruning threshold for SNN graph (default: 1/15)</p></dd>


<dt id="arg-n-pcs">n.pcs<a class="anchor" aria-label="anchor" href="#arg-n-pcs"></a></dt>
<dd><p>Number of principal components to use</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>Resolution parameter for clustering</p></dd>


<dt id="arg-n-start">n.start<a class="anchor" aria-label="anchor" href="#arg-n-start"></a></dt>
<dd><p>Number of random starts (default: 10)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether to print progress messages (default: TRUE)</p></dd>


<dt id="arg-segment-type">segment_type<a class="anchor" aria-label="anchor" href="#arg-segment-type"></a></dt>
<dd><p>For SAP objects: Type of segments ('motifs', 'syllables', 'segments')</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>For SAP objects: Type of feature data ('spectral_feature', "spectrogram")</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>For SAP objects: Specific label to filter data</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For default method: Data frame with metadata columns and cluster assignments
For SAP objects: Updated object with clustering results in features slot</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For feature data frames:</p><ul><li><p>Separates metadata and feature columns</p></li>
<li><p>Finds nearest neighbors using PCA</p></li>
<li><p>Constructs SNN graph</p></li>
<li><p>Performs community detection</p></li>
</ul><p>For SAP objects:</p><ul><li><p>Supports multiple segment types</p></li>
<li><p>Optional label filtering</p></li>
<li><p>Stores results in features slot</p></li>
<li><p>Updates feature embeddings</p></li>
</ul><p>The clustering approach is similar to that used in Seurat V3, implementing:</p><ul><li><p>PCA-based neighbor finding</p></li>
<li><p>SNN graph construction</p></li>
<li><p>Louvain community detection</p></li>
</ul><p>Original source: Seurat package
(<a href="https://github.com/satijalab/seurat/blob/main/inst/CITATION" class="external-link">https://github.com/satijalab/seurat/blob/main/inst/CITATION</a>)</p>
<p>These functions are based on methods developed in the following publications:</p><ul><li><p>Hao Y, et al. (2023). Dictionary learning for integrative, multimodal
and scalable single-cell analysis. <em>Nature Biotechnology</em>.
doi:10.1038/s41587-023-01767-y</p></li>
<li><p>Hao Y, Hao S, et al. (2021). Integrated analysis of multimodal
single-cell data. <em>Cell</em>.
doi:10.1016/j.cell.2021.04.048</p></li>
<li><p>Stuart T, Butler A, et al. (2019). Comprehensive Integration of
Single-Cell Data. <em>Cell</em>.
doi:10.1016/j.cell.2019.05.031</p></li>
<li><p>Butler A, et al. (2018). Integrating single-cell transcriptomic data
across different conditions, technologies, and species.
<em>Nature Biotechnology</em>.
doi:10.1038/nbt.4096</p></li>
<li><p>Satija R, et al. (2015). Spatial reconstruction of single-cell gene
expression data. <em>Nature Biotechnology</em>.
doi:10.1038/nbt.3192</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="run_umap.html">run_umap</a></code> for visualization of clusters</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic clustering of feature data</span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu">find_clusters</span><span class="op">(</span><span class="va">features</span>,</span></span>
<span class="r-in"><span>                         metadata_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering with custom parameters</span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu">find_clusters</span><span class="op">(</span><span class="va">features</span>,</span></span>
<span class="r-in"><span>                         metadata_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         k.param <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>                         resolution <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cluster SAP object features</span></span></span>
<span class="r-in"><span><span class="va">sap_obj</span> <span class="op">&lt;-</span> <span class="fu">find_clusters</span><span class="op">(</span><span class="va">sap_object</span>,</span></span>
<span class="r-in"><span>                        segment_type <span class="op">=</span> <span class="st">"motifs"</span>,</span></span>
<span class="r-in"><span>                        data_type <span class="op">=</span> <span class="st">"spectral_feature"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Label-specific clustering</span></span></span>
<span class="r-in"><span><span class="va">sap_obj</span> <span class="op">&lt;-</span> <span class="fu">find_clusters</span><span class="op">(</span><span class="va">sap_object</span>,</span></span>
<span class="r-in"><span>                        segment_type <span class="op">=</span> <span class="st">"syllables"</span>,</span></span>
<span class="r-in"><span>                        label <span class="op">=</span> <span class="st">"a"</span>,</span></span>
<span class="r-in"><span>                        resolution <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lei Xiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

